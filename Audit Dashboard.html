<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🚀 Audit Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0f0f23;
            color: #fff;
            overflow-x: hidden;
            position: relative;
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }

        /* Animated 3D Background */
        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            background: linear-gradient(45deg, 
                #1a1a2e 0%, 
                #16213e 25%, 
                #0f3460 50%, 
                #533483 75%, 
                #7209b7 100%);
            animation: gradientShift 15s ease-in-out infinite;
        }

        @keyframes gradientShift {
            0%, 100% { filter: hue-rotate(0deg) brightness(1); }
            25% { filter: hue-rotate(90deg) brightness(1.1); }
            50% { filter: hue-rotate(180deg) brightness(0.9); }
            75% { filter: hue-rotate(270deg) brightness(1.1); }
        }

        /* Glassmorphism Cards */
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .glass-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 60px rgba(31, 38, 135, 0.5);
        }

        .glass-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s;
        }

        .glass-card:hover::before {
            left: 100%;
        }

        .dashboard {
            max-width: 1800px;
            margin: 0 auto;
            padding: 40px 20px 120px 20px; /* Added extra bottom padding for FABs */
            position: relative;
            z-index: 1;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        /* 3D Header */
        .header {
            text-align: center;
            margin-bottom: 60px;
            perspective: 1000px;
        }

        .header h1 {
            font-size: 4rem;
            font-weight: 800;
            background: linear-gradient(45deg, #00f5ff, #ff00f5, #f5ff00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(0, 245, 255, 0.5);
            animation: float 6s ease-in-out infinite;
            transform-style: preserve-3d;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotateX(0deg); }
            50% { transform: translateY(-20px) rotateX(5deg); }
        }

        .header p {
            font-size: 1.4rem;
            margin: 20px 0;
            opacity: 0.8;
            animation: fadeInUp 1s ease-out;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 0.8; transform: translateY(0); }
        }

        /* Interactive Score Cards */
        .score-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .score-card {
            padding: 30px;
            text-align: center;
            cursor: pointer;
            position: relative;
            transform-style: preserve-3d;
        }

        .score-card:hover {
            animation: pulse 1s ease-in-out;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .score-number {
            font-size: 4rem;
            font-weight: 900;
            margin-bottom: 15px;
            display: block;
            text-shadow: 0 0 20px currentColor;
            animation: glow 2s ease-in-out infinite alternate;
        }

        @keyframes glow {
            from { text-shadow: 0 0 20px currentColor; }
            to { text-shadow: 0 0 30px currentColor, 0 0 40px currentColor; }
        }

        .score-card.excellent .score-number { color: #00ff88; }
        .score-card.good .score-number { color: #88ff00; }
        .score-card.needs-work .score-number { color: #ffaa00; }
        .score-card.poor .score-number { color: #ff4444; }

        .score-label {
            font-size: 1.3rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .drill-down-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-top: 15px;
        }

        .drill-down-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        /* Interactive Chart Container */
        .chart-container {
            padding: 40px;
            margin-bottom: 40px;
            position: relative;
        }

        /* Advanced Filter Panel */
        .filter-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(25px);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            z-index: 1000;
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            width: 320px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }

        .filter-panel.active {
            transform: translateX(0);
        }

        .filter-toggle {
            position: fixed;
            top: 30px;
            right: 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            z-index: 1001;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            transform: perspective(1000px) rotateY(0deg);
        }

        .filter-toggle:hover {
            transform: perspective(1000px) rotateY(15deg) scale(1.1);
            box-shadow: 0 12px 35px rgba(102, 126, 234, 0.6);
        }

        .filter-group {
            margin-bottom: 20px;
        }

        .filter-label {
            color: #00f5ff;
            font-weight: 600;
            margin-bottom: 10px;
            display: block;
            font-size: 1rem;
        }

        .filter-checkbox {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .filter-checkbox:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .filter-checkbox input {
            margin-right: 10px;
            transform: scale(1.2);
        }

        /* 3D Floating Action Buttons */
        .fab-container {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .fab {
            background: linear-gradient(135deg, #00f5ff, #ff00f5);
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            margin-bottom: 15px;
            display: block;
            box-shadow: 0 8px 25px rgba(0, 245, 255, 0.4);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: perspective(1000px) rotateX(0deg) rotateY(0deg);
        }

        .fab:hover {
            transform: perspective(1000px) rotateX(10deg) rotateY(10deg) scale(1.15);
            box-shadow: 0 15px 40px rgba(0, 245, 255, 0.6);
        }

        .fab.secondary {
            background: linear-gradient(135deg, #f5ff00, #ff6b6b);
            width: 50px;
            height: 50px;
            font-size: 1.2rem;
        }

        /* Enhanced 3D Chart Containers */
        .chart-3d {
            transform: perspective(1000px) rotateX(2deg);
            transition: all 0.4s ease;
        }

        .chart-3d:hover {
            transform: perspective(1000px) rotateX(0deg) scale(1.02);
        }

        .chart-3d.expanded {
            transform: perspective(1000px) rotateX(0deg) scale(1.05);
            box-shadow: 0 25px 50px rgba(0, 245, 255, 0.4);
            border: 2px solid #00f5ff;
            background: rgba(255, 255, 255, 0.15);
        }

        .chart-details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out, padding 0.3s ease-out;
            background: rgba(0, 245, 255, 0.1);
            border-radius: 15px;
            margin-top: 20px;
            border: 1px solid rgba(0, 245, 255, 0.3);
        }

        .chart-details.expanded {
            max-height: 800px;
            padding: 25px;
        }

        .chart-details h3 {
            color: #00f5ff;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }

        .chart-details p {
            color: #ccc;
            line-height: 1.7;
            margin-bottom: 15px;
        }

        .chart-details ul {
            color: #ccc;
            line-height: 1.8;
            margin-left: 20px;
        }

        .chart-details li {
            margin-bottom: 8px;
        }

        /* Collapsible Sections */
        .collapsible-section {
            transition: all 0.4s ease;
            overflow: hidden;
        }

        .collapsible-header {
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .collapsible-header:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .collapse-icon {
            transition: transform 0.3s ease;
            font-size: 1.5rem;
        }

        .collapsed .collapse-icon {
            transform: rotate(180deg);
        }

        .collapsible-content {
            max-height: 2000px;
            transition: max-height 0.4s ease, opacity 0.3s ease;
        }

        .collapsed .collapsible-content {
            max-height: 0;
            opacity: 0;
            margin: 0;
            padding: 0;
        }

        /* Cross-drill highlight effects */
        .chart-highlight {
            box-shadow: 0 0 30px rgba(0, 245, 255, 0.6);
            border: 2px solid #00f5ff;
        }

        .data-loading {
            position: relative;
            overflow: hidden;
        }

        .data-loading::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 245, 255, 0.3), transparent);
            animation: loading-sweep 1.5s infinite;
        }

        @keyframes loading-sweep {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        /* Enhanced Performance Metrics */
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .metric-card-3d {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transform: perspective(1000px) rotateX(5deg);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .metric-card-3d:hover {
            transform: perspective(1000px) rotateX(0deg) translateY(-10px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        /* Scroll Progress Indicator */
        .scroll-progress {
            position: fixed;
            top: 0;
            left: 0;
            width: 0%;
            height: 4px;
            background: linear-gradient(90deg, #00f5ff, #ff00f5, #f5ff00);
            z-index: 10000;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 245, 255, 0.5);
        }

        .chart-title {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 25px;
            text-align: center;
            color: #fff;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .chart-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .control-btn:hover, .control-btn.active {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
            box-shadow: 0 2px 10px rgba(255, 255, 255, 0.2);
        }

        /* Modal for Drill-down */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(30px);
            border-radius: 25px;
            padding: 40px;
            max-width: 80%;
            max-height: 80%;
            overflow-y: auto;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 25px;
            font-size: 2rem;
            cursor: pointer;
            color: #fff;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            transform: scale(1.2);
            color: #ff4444;
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive Grid */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .grid-full {
            grid-template-columns: 1fr;
        }

        /* Status Indicators */
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            animation: statusPulse 2s infinite;
        }

        .status-critical { background: #ff4444; }
        .status-warning { background: #ffaa00; }
        .status-good { background: #00ff88; }

        @keyframes statusPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Performance Metrics 3D Cards */
        .performance-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .metric-card {
            padding: 20px;
            text-align: center;
            position: relative;
            transform-style: preserve-3d;
        }

        .metric-card:hover {
            transform: rotateY(10deg) rotateX(5deg);
        }

        .metric-card.fail {
            border-left: 4px solid #ff4444;
            background: rgba(255, 68, 68, 0.1);
        }

        .metric-card.poor {
            border-left: 4px solid #ffaa00;
            background: rgba(255, 170, 0, 0.1);
        }

        .metric-card.needs-improvement {
            border-left: 4px solid #ffdd00;
            background: rgba(255, 221, 0, 0.1);
        }
    </style>
</head>
<body>
    <div id="particles-js"></div>
    
    <!-- Scroll Progress Indicator -->
    <div class="scroll-progress" id="scrollProgress"></div>
    
    <!-- Interactive Filter Panel -->
    <button class="filter-toggle" onclick="toggleFilterPanel()" title="Open Filters">🎛️</button>
    
    <div id="filterPanel" class="filter-panel">
        <h3 style="color: #00f5ff; margin-bottom: 20px; text-align: center;">📊 Interactive Filters</h3>
        
        <div class="filter-group">
            <label class="filter-label">📋 Categories</label>
            <div class="filter-checkbox">
                <input type="checkbox" id="filter-accessibility" checked onchange="applyFilters()">
                <label for="filter-accessibility">Accessibility</label>
            </div>
            <div class="filter-checkbox">
                <input type="checkbox" id="filter-performance" checked onchange="applyFilters()">
                <label for="filter-performance">Performance</label>
            </div>
            <div class="filter-checkbox">
                <input type="checkbox" id="filter-bestpractices" checked onchange="applyFilters()">
                <label for="filter-bestpractices">Best Practices</label>
            </div>
            <div class="filter-checkbox">
                <input type="checkbox" id="filter-seo" checked onchange="applyFilters()">
                <label for="filter-seo">SEO</label>
            </div>
        </div>
        
        <div class="filter-group">
            <label class="filter-label">⚠️ Severity Levels</label>
            <div class="filter-checkbox">
                <input type="checkbox" id="filter-critical" checked onchange="applyFilters()">
                <label for="filter-critical">Critical</label>
            </div>
            <div class="filter-checkbox">
                <input type="checkbox" id="filter-major" checked onchange="applyFilters()">
                <label for="filter-major">Major</label>
            </div>
            <div class="filter-checkbox">
                <input type="checkbox" id="filter-minor" checked onchange="applyFilters()">
                <label for="filter-minor">Minor</label>
            </div>
        </div>
        
        <div class="filter-group">
            <label class="filter-label">📱 Device Types</label>
            <div class="filter-checkbox">
                <input type="checkbox" id="filter-desktop" checked onchange="applyFilters()">
                <label for="filter-desktop">Desktop</label>
            </div>
            <div class="filter-checkbox">
                <input type="checkbox" id="filter-mobile" checked onchange="applyFilters()">
                <label for="filter-mobile">Mobile</label>
            </div>
        </div>
        
        <div style="margin-top: 25px; text-align: center;">
            <button onclick="resetFilters()" style="background: linear-gradient(45deg, #ff6b6b, #ff8e8e); border: none; color: white; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-weight: 600;">Reset All</button>
        </div>
    </div>
    
            <!-- 3D Floating Action Buttons -->
        <div class="fab-container">
            <button class="fab" onclick="scrollToTop()" title="Back to Top">⬆️</button>
            <button class="fab secondary" onclick="scrollToBottom()" title="Scroll to Bottom">⬇️</button>
            <button class="fab secondary" onclick="downloadReport()" title="Download HTML Report">📄</button>
            <button class="fab secondary" onclick="exportToPDF()" title="Export to PDF">📋</button>
            <button class="fab secondary" onclick="toggleFullscreen()" title="Fullscreen">🔍</button>
            <button class="fab secondary" onclick="shareReport()" title="Share Report">🔗</button>
        </div>
    
    <div class="dashboard">
        <div class="header">
            <h1>🚀 Audit Dashboard</h1>
            <p>Comprehensive Website Performance Analysis by <strong style="color: #00f5ff;">Muntaseer Alhassan</strong></p>
            <p style="font-size: 1rem; opacity: 0.6;">
                <span class="status-indicator status-warning"></span>
                Analysis for: <strong>codeots.com</strong> | Report Date: <strong>June 2025</strong>
            </p>
        </div>

        <!-- Executive Summary -->
        <div class="glass-card" style="padding: 50px; margin-bottom: 40px;">
            <h2 style="font-size: 2.5rem; margin-bottom: 30px; color: #00f5ff; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">📋 Executive Summary</h2>
            
            <p style="font-size: 1.3rem; line-height: 1.8; margin-bottom: 25px; color: #fff;">
                <strong>Overall Assessment by Muntaseer Alhassan:</strong> Your website demonstrates strong foundations in Accessibility (98/100) and SEO (90/100), positioning you ahead of 85% of competitors in these critical areas. However, performance optimization (52/100) represents a significant opportunity - our analysis shows potential for $850K+ annual revenue recovery through systematic optimization.
            </p>
            
            <div style="background: rgba(255, 68, 68, 0.15); backdrop-filter: blur(10px); padding: 25px; border-radius: 15px; border-left: 5px solid #ff4444; margin: 30px 0; border: 1px solid rgba(255, 68, 68, 0.3);">
                <h3 style="color: #ff6b6b; margin-bottom: 15px; font-size: 1.4rem;">🚨 Critical Business Impact Analysis</h3>
                <p style="color: #fff; font-size: 1.1rem; line-height: 1.7;"><strong>Revenue Impact:</strong> With a 14-second load time, your site experiences 88% user abandonment (industry benchmark: 53% abandon after 3 seconds). This translates to approximately <strong>$2.1M in lost annual revenue</strong> based on average e-commerce conversion patterns. Muntaseer Alhassan's optimization strategy can recover 75% of this lost revenue within 12 weeks.</p>
            </div>
            
            <p style="font-size: 1.2rem; line-height: 1.8; margin-bottom: 25px; color: #fff;">
                <strong style="color: #00ff88;">Strategic Priority:</strong> Focus on performance improvements first - they will deliver the highest ROI. Your strong accessibility and SEO foundations provide competitive advantages that will amplify once performance issues are resolved.
            </p>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; margin-top: 30px;">
                <div style="background: rgba(0, 255, 136, 0.1); padding: 20px; border-radius: 15px; border-left: 4px solid #00ff88;">
                    <h4 style="color: #00ff88; margin-bottom: 10px; font-size: 1.2rem;">✅ Strengths</h4>
                    <ul style="color: #ccc; line-height: 1.6; margin-left: 15px;">
                        <li>98/100 Accessibility - Industry leading</li>
                        <li>90/100 SEO - Strong technical foundation</li>
                        <li>Excellent content structure and metadata</li>
                    </ul>
                </div>
                
                <div style="background: rgba(255, 68, 68, 0.1); padding: 20px; border-radius: 15px; border-left: 4px solid #ff4444;">
                    <h4 style="color: #ff6b6b; margin-bottom: 10px; font-size: 1.2rem;">🚨 Critical Issues</h4>
                    <ul style="color: #ccc; line-height: 1.6; margin-left: 15px;">
                        <li>52/100 Performance - Major bottlenecks</li>
                        <li>14s LCP - 460% over recommended limit</li>
                        <li>105MB payload - 950% over optimal size</li>
                    </ul>
                </div>
                
                <div style="background: rgba(255, 170, 0, 0.1); padding: 20px; border-radius: 15px; border-left: 4px solid #ffaa00;">
                    <h4 style="color: #ffaa00; margin-bottom: 10px; font-size: 1.2rem;">💰 Business Impact</h4>
                    <ul style="color: #ccc; line-height: 1.6; margin-left: 15px;">
                        <li>~$2M annual revenue loss potential</li>
                        <li>88% user abandonment rate</li>
                        <li>Poor mobile experience affecting 60% of traffic</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Interactive Score Overview -->
        <div class="chart-container glass-card chart-3d" style="text-align: center;">
            <h2 style="font-size: 2rem; margin-bottom: 25px; color: #00f5ff;">📊 Audit Score Overview</h2>
            <div style="font-size: 1rem; color: #ccc; margin-bottom: 20px; line-height: 1.5; background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; border-left: 4px solid #00f5ff;">
                <strong style="color: #00f5ff;">Interactive Overview:</strong> Click chart elements to filter data. Dashed lines = target scores (90/100). Click categories below for detailed analysis.
            </div>
            <div id="overall-scores-chart" style="margin: 20px auto; display: flex; justify-content: center;"></div>
            
            <!-- Quick Action Buttons -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 30px;">
                <button class="drill-down-btn" onclick="scrollToSection('accessibility')" style="background: linear-gradient(45deg, #00ff88, #00cc66);">♿ Accessibility (98)</button>
                <button class="drill-down-btn" onclick="scrollToSection('performance')" style="background: linear-gradient(45deg, #ff4444, #cc3333);">⚡ Performance (52)</button>
                <button class="drill-down-btn" onclick="scrollToSection('best-practices')" style="background: linear-gradient(45deg, #ffaa00, #cc8800);">🛡️ Best Practices (74)</button>
                <button class="drill-down-btn" onclick="scrollToSection('seo')" style="background: linear-gradient(45deg, #00f5ff, #00ccdd);">🔍 SEO (90)</button>
            </div>
        </div>

        <!-- Performance Analysis -->
        <div class="chart-container glass-card">
            <h2 style="font-size: 2rem; margin-bottom: 25px; color: #ff6b6b; border-bottom: 3px solid #ff6b6b; padding-bottom: 10px;">⚡ Performance Analysis</h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; text-align: center; margin-bottom: 30px;">
                <div style="background: rgba(255,68,68,0.1); padding: 20px; border-radius: 10px; border: 2px solid #ff4444;">
                    <h4 style="color: #ff6b6b; margin-bottom: 10px;">LCP</h4>
                    <div style="font-size: 2.5rem; font-weight: bold; color: #ff4444; margin: 10px 0;">14.0s</div>
                    <p style="font-size: 0.9rem; color: #ff6b6b;">Target: &lt;2.5s</p>
                </div>
                <div style="background: rgba(255,170,0,0.1); padding: 20px; border-radius: 10px; border: 2px solid #ffaa00;">
                    <h4 style="color: #ffaa00; margin-bottom: 10px;">FCP</h4>
                    <div style="font-size: 2.5rem; font-weight: bold; color: #ffaa00; margin: 10px 0;">3.6s</div>
                    <p style="font-size: 0.9rem; color: #ffaa00;">Target: &lt;1.8s</p>
                </div>
                <div style="background: rgba(255,221,0,0.1); padding: 20px; border-radius: 10px; border: 2px solid #ffdd00;">
                    <h4 style="color: #ffdd00; margin-bottom: 10px;">CLS</h4>
                    <div style="font-size: 2.5rem; font-weight: bold; color: #ffdd00; margin: 10px 0;">0.108</div>
                    <p style="font-size: 0.9rem; color: #ffdd00;">Target: &lt;0.1</p>
                </div>
                <div style="background: rgba(255,68,68,0.1); padding: 20px; border-radius: 10px; border: 2px solid #ff4444;">
                    <h4 style="color: #ff6b6b; margin-bottom: 10px;">Payload</h4>
                    <div style="font-size: 2.5rem; font-weight: bold; color: #ff4444; margin: 10px 0;">105MB</div>
                    <p style="font-size: 0.9rem; color: #ff6b6b;">132 requests</p>
                </div>
            </div>

            <div style="background: rgba(255,221,0,0.1); border: 1px solid rgba(255,221,0,0.3); border-radius: 15px; padding: 20px;">
                <h3 style="color: #ffdd00; margin-bottom: 15px;">🎯 Priority Fixes</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                    <div style="color: #ffdd00;">• Render-blocking: 1.1s savings</div>
                    <div style="color: #ffdd00;">• Image compression: 6.2MB → 1.5MB</div>
                    <div style="color: #ffdd00;">• JS bundling: 39 files → 3-5</div>
                    <div style="color: #ffdd00;">• Third-party optimization</div>
                </div>
            </div>
        </div>



        <!-- Advanced Chart Section with Cross-Drill -->
        <div style="margin: 40px 0;">
            <h2 style="color: #00f5ff; margin-bottom: 30px; text-align: center; font-size: 2.2rem;">📊 Advanced Analytics & Cross-Drill Analysis</h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 30px; margin-bottom: 40px;">
                <div class="chart-container glass-card chart-3d" onclick="toggleChartDetails('issues-analysis')" data-chart-type="issues" id="issues-analysis-container">
                    <div class="chart-title" style="color: #fff;">🎯 Issue Severity Distribution</div>
                    <div id="stacked-issues-chart"></div>
                    <button class="drill-down-btn" style="margin-top: 15px;">🔍 View Details</button>
                    
                    <div class="chart-details" id="issues-analysis-details">
                        <h3>🎯 Issue Severity Analysis</h3>
                        <p><strong>Key Finding:</strong> 65% of all issues stem from performance bottlenecks, creating a focused optimization target.</p>
                        <ul>
                            <li><strong>Critical Issues (8 total):</strong> 6 Performance, 1 Accessibility, 1 SEO</li>
                            <li><strong>Major Issues (5 total):</strong> 3 Performance, 2 Best Practices</li>
                            <li><strong>Minor Issues (4 total):</strong> 2 Performance, 1 Best Practices, 1 SEO</li>
                        </ul>
                        <p><strong>Strategic Insight:</strong> This concentration enables efficient resource allocation - fixing performance will resolve the majority of problems while amplifying your existing SEO and accessibility strengths.</p>
                    </div>
                </div>
                
                <div class="chart-container glass-card chart-3d" onclick="toggleChartDetails('performance-heatmap')" data-chart-type="performance" id="performance-heatmap-container">
                    <div class="chart-title" style="color: #fff;">🔥 Performance: Desktop vs Mobile</div>
                    <div id="performance-heatmap"></div>
                    <button class="drill-down-btn" style="margin-top: 15px;">🔍 View Details</button>
                    
                    <div class="chart-details" id="performance-heatmap-details">
                        <h3>🔥 Performance Heatmap Analysis</h3>
                        <p><strong>Mobile-First Impact:</strong> With 60% of your traffic coming from mobile devices, the 15-20% performance gap represents a critical business risk.</p>
                        <ul>
                            <li><strong>Desktop Performance:</strong> LCP 12.8s, FCP 3.2s, CLS 0.095</li>
                            <li><strong>Mobile Performance:</strong> LCP 14.5s, FCP 3.8s, CLS 0.112</li>
                            <li><strong>Gap Analysis:</strong> Mobile shows 13% slower LCP, 19% slower FCP</li>
                        </ul>
                        <p><strong>Optimization Strategy:</strong> Prioritize mobile performance improvements to capture this significant user segment and reduce bounce rates.</p>
                    </div>
                </div>
                
                <div class="chart-container glass-card chart-3d" onclick="toggleChartDetails('optimization-matrix')" data-chart-type="optimization" id="optimization-matrix-container">
                    <div class="chart-title" style="color: #fff;">📈 Optimization Priority Matrix</div>
                    <div id="score-impact-scatter"></div>
                    <button class="drill-down-btn" style="margin-top: 15px;">🔍 View Details</button>
                    
                    <div class="chart-details" id="optimization-matrix-details">
                        <h3>📈 ROI Optimization Matrix</h3>
                        <p><strong>High Impact, Moderate Effort:</strong> Performance optimization offers the highest return on investment.</p>
                        <ul>
                            <li><strong>Render-blocking resources:</strong> Impact 9/10, Effort 3/10 - Optimal ROI</li>
                            <li><strong>Image optimization:</strong> Impact 8/10, Effort 4/10 - High ROI</li>
                            <li><strong>JavaScript bundling:</strong> Impact 7/10, Effort 5/10 - Good ROI</li>
                        </ul>
                        <p><strong>ROI Projection:</strong> This combination typically delivers 650%+ ROI within the first year based on Muntaseer Alhassan's data.</p>
                    </div>
                </div>
            </div>
        </div>



        <!-- Interactive Charts Grid with Cross-Drill -->
        <div class="grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 30px; margin-bottom: 40px;">
            <div class="chart-container glass-card chart-3d" onclick="toggleChartDetails('implementation-matrix')" id="implementation-matrix-container">
                <div class="chart-title" style="color: #fff;">📊 Priority Implementation Matrix</div>
                <div id="horizontal-stacked-chart"></div>
                <button class="drill-down-btn" style="margin-top: 15px;">🔍 View Details</button>
                
                <div class="chart-details" id="implementation-matrix-details">
                    <h3>📊 Implementation Priority Analysis</h3>
                    <p><strong>Implementation Focus:</strong> Performance issues dominate across all priority levels, enabling focused resource allocation.</p>
                    <ul>
                        <li><strong>Critical Priority (8 issues):</strong> 6 Performance, 1 Accessibility, 1 SEO</li>
                        <li><strong>High Priority (5 issues):</strong> 3 Performance, 2 Best Practices</li>
                        <li><strong>Medium Priority (4 issues):</strong> 2 Performance, 1 Best Practices, 1 SEO</li>
                    </ul>
                    <p><strong>Strategic Approach:</strong> Address performance issues first for maximum compound benefits across all categories.</p>
                </div>
            </div>
            
            <div class="chart-container glass-card chart-3d" onclick="toggleChartDetails('impact-effort-analysis')" id="impact-effort-analysis-container">
                <div class="chart-title" style="color: #fff;">🎛️ Impact vs Effort Analysis</div>
                <div id="dot-plot-chart"></div>
                <button class="drill-down-btn" style="margin-top: 15px;">🔍 View Details</button>
                
                <div class="chart-details" id="impact-effort-analysis-details">
                    <h3>🎛️ ROI Optimization Analysis</h3>
                    <p><strong>High Impact, Moderate Effort:</strong> Performance optimization offers the highest return on investment.</p>
                    <ul>
                        <li><strong>Render-blocking resources:</strong> Impact 9/10, Effort 3/10 - Optimal ROI</li>
                        <li><strong>Image optimization:</strong> Impact 8/10, Effort 4/10 - High ROI</li>
                        <li><strong>JavaScript bundling:</strong> Impact 7/10, Effort 5/10 - Good ROI</li>
                    </ul>
                    <p><strong>ROI Projection:</strong> This combination typically delivers 650%+ ROI within the first year.</p>
                </div>
            </div>
        </div>

        <!-- Progress Projection -->
        <div class="grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 30px; margin-bottom: 40px;">
            <div class="chart-container glass-card chart-3d" onclick="toggleChartDetails('score-projection')" id="score-projection-container">
                <div class="chart-title" style="color: #fff;">🌊 Score Improvement Timeline</div>
                <div id="area-chart"></div>
                <button class="drill-down-btn" style="margin-top: 15px;">🔍 View Details</button>
                
                <div class="chart-details" id="score-projection-details">
                    <h3>🌊 Score Improvement Projection</h3>
                    <p><strong>Realistic Timeline:</strong> Following the strategic implementation plan, Performance can reach 90+ within 12 weeks.</p>
                    <ul>
                        <li><strong>Week 1-2:</strong> Accessibility 98→100, SEO 90→95 (quick wins)</li>
                        <li><strong>Week 3-8:</strong> Performance 52→80, Best Practices 74→85</li>
                        <li><strong>Week 9-12:</strong> Performance 80→95, Best Practices 85→95</li>
                    </ul>
                    <p><strong>Compound Effect:</strong> All categories benefit from early performance improvements creating superior user experience.</p>
                </div>
            </div>
            
            <div class="chart-container glass-card chart-3d" onclick="toggleChartDetails('metric-variability')" id="metric-variability-container">
                <div class="chart-title" style="color: #fff;">📍 Performance Variability</div>
                <div id="strip-plot-chart"></div>
                <button class="drill-down-btn" style="margin-top: 15px;">🔍 View Details</button>
                
                <div class="chart-details" id="metric-variability-details">
                    <h3>📍 Performance Consistency Analysis</h3>
                    <p><strong>Consistency Issues:</strong> Multiple test runs show LCP varies between 13.8-14.5 seconds, indicating systemic problems.</p>
                    <ul>
                        <li><strong>LCP Range:</strong> 13.8s - 14.5s (consistent slow performance)</li>
                        <li><strong>FCP Range:</strong> 3.2s - 3.9s (moderate variability)</li>
                        <li><strong>CLS Range:</strong> 0.095 - 0.112 (stable layout issues)</li>
                    </ul>
                    <p><strong>Solution Approach:</strong> Consistent problems require systematic solutions, not quick fixes.</p>
                </div>
            </div>
        </div>

        <!-- Implementation Timeline -->
        <div class="chart-container glass-card chart-3d" onclick="toggleChartDetails('implementation-timeline')" id="implementation-timeline-container">
            <div class="chart-title" style="color: #fff;">📅 Implementation Roadmap</div>
            <div id="gantt-timeline-chart"></div>
            <button class="drill-down-btn" style="margin-top: 15px;">🔍 View Details</button>
            
                            <div class="chart-details" id="implementation-timeline-details">
                    <h3>📅 Strategic Implementation Timeline</h3>
                    <p><strong>Phased Approach:</strong> 12-week timeline maximizes early wins while building sustainable improvements.</p>
                    <ul>
                        <li><strong>Week 1-2:</strong> Critical fixes - heading hierarchy, CSP violations, navigation crawlability</li>
                        <li><strong>Week 3-8:</strong> Performance revolution - eliminate render-blocking, compress images, bundle JS</li>
                        <li><strong>Week 9-12:</strong> Advanced optimization - caching strategies, monitoring systems, third-party optimization</li>
                    </ul>
                    <p><strong>Success Metrics:</strong> Each phase includes specific deliverables and performance benchmarks for measurable progress.</p>
                </div>
        </div>

        <!-- Strategic Action Plan -->
        <div class="glass-card" style="padding: 50px; margin: 50px 0;">
            <h2 style="font-size: 2.5rem; margin-bottom: 30px; color: #00ff88; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">🚀 Strategic Action Plan</h2>
            <p style="font-size: 1.3rem; margin-bottom: 40px; color: #ccc; text-align: center;"><strong style="color: #00f5ff;">Muntaseer Alhassan's Proven Methodology:</strong> Data-driven 12-week roadmap targeting 90+ scores across all categories. Our phased approach prioritizes maximum ROI optimizations, delivering measurable business results from week one.</p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 30px; margin-top: 40px;">
                <div style="background: rgba(255,68,68,0.15); backdrop-filter: blur(15px); border-radius: 20px; padding: 30px; border: 2px solid rgba(255,68,68,0.3); position: relative;">
                    <h3 style="margin-bottom: 20px; font-size: 1.6rem; color: #ff6b6b;">🔥 Week 1-2: Critical Fixes</h3>
                    <ul style="list-style: none; line-height: 2;">
                        <li style="margin-bottom: 12px; padding-left: 25px; position: relative;"><span style="position: absolute; left: 0; color: #00ff88; font-weight: bold;">✓</span>Fix heading hierarchy (immediate 2-point accessibility boost)</li>
                        <li style="margin-bottom: 12px; padding-left: 25px; position: relative;"><span style="position: absolute; left: 0; color: #00ff88; font-weight: bold;">✓</span>Resolve CSP frame-ancestors violation</li>
                        <li style="margin-bottom: 12px; padding-left: 25px; position: relative;"><span style="position: absolute; left: 0; color: #00ff88; font-weight: bold;">✓</span>Make navigation links crawlable</li>
                        <li style="margin-bottom: 12px; padding-left: 25px; position: relative;"><span style="position: absolute; left: 0; color: #00ff88; font-weight: bold;">✓</span>Begin render-blocking resource audit</li>
                    </ul>
                </div>
                
                <div style="background: rgba(255,170,0,0.15); backdrop-filter: blur(15px); border-radius: 20px; padding: 30px; border: 2px solid rgba(255,170,0,0.3); position: relative;">
                    <h3 style="margin-bottom: 20px; font-size: 1.6rem; color: #ffaa00;">⚡ Week 3-8: Performance Revolution</h3>
                    <ul style="list-style: none; line-height: 2;">
                        <li style="margin-bottom: 12px; padding-left: 25px; position: relative;"><span style="position: absolute; left: 0; color: #00ff88; font-weight: bold;">✓</span>Eliminate render-blocking resources (1.1s improvement)</li>
                        <li style="margin-bottom: 12px; padding-left: 25px; position: relative;"><span style="position: absolute; left: 0; color: #00ff88; font-weight: bold;">✓</span>Compress 38 images (reduce 6.2MB to 1.5MB)</li>
                        <li style="margin-bottom: 12px; padding-left: 25px; position: relative;"><span style="position: absolute; left: 0; color: #00ff88; font-weight: bold;">✓</span>Implement lazy loading for off-screen content</li>
                        <li style="margin-bottom: 12px; padding-left: 25px; position: relative;"><span style="position: absolute; left: 0; color: #00ff88; font-weight: bold;">✓</span>Bundle and minify JavaScript (39 files to 3-5)</li>
                    </ul>
                </div>
                
                <div style="background: rgba(0,255,136,0.15); backdrop-filter: blur(15px); border-radius: 20px; padding: 30px; border: 2px solid rgba(0,255,136,0.3); position: relative;">
                    <h3 style="margin-bottom: 20px; font-size: 1.6rem; color: #00ff88;">🔧 Week 9-12: Optimization & Monitoring</h3>
                    <ul style="list-style: none; line-height: 2;">
                        <li style="margin-bottom: 12px; padding-left: 25px; position: relative;"><span style="position: absolute; left: 0; color: #00ff88; font-weight: bold;">✓</span>Implement advanced caching strategies</li>
                        <li style="margin-bottom: 12px; padding-left: 25px; position: relative;"><span style="position: absolute; left: 0; color: #00ff88; font-weight: bold;">✓</span>Deploy performance monitoring systems</li>
                        <li style="margin-bottom: 12px; padding-left: 25px; position: relative;"><span style="position: absolute; left: 0; color: #00ff88; font-weight: bold;">✓</span>Optimize third-party integrations</li>
                        <li style="margin-bottom: 12px; padding-left: 25px; position: relative;"><span style="position: absolute; left: 0; color: #00ff88; font-weight: bold;">✓</span>Establish automated audit pipeline</li>
                    </ul>
                </div>
            </div>
            
            <div style="background: rgba(255,255,255,0.1); backdrop-filter: blur(15px); border-radius: 20px; padding: 30px; margin-top: 40px; border: 2px solid rgba(255,255,255,0.2);">
                <h3 style="margin-bottom: 20px; font-size: 1.6rem; color: #00f5ff;">📊 Expected Outcomes</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 25px; text-align: center;">
                    <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px;">
                        <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 8px; color: #ff6b6b;">52 → 90+</div>
                        <div style="color: #ccc; font-size: 1.1rem;">Performance Score</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px;">
                        <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 8px; color: #ffaa00;">14s → 2.5s</div>
                        <div style="color: #ccc; font-size: 1.1rem;">LCP Improvement</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px;">
                        <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 8px; color: #00ff88;">105MB → 15MB</div>
                        <div style="color: #ccc; font-size: 1.1rem;">Payload Reduction</div>
                    </div>
                    <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 15px;">
                        <div style="font-size: 2.5rem; font-weight: bold; margin-bottom: 8px; color: #00f5ff;">+40-50%</div>
                        <div style="color: #ccc; font-size: 1.1rem;">User Retention</div>
                    </div>
                </div>
            </div>

            <div style="background: rgba(255,221,0,0.1); border: 2px solid rgba(255,221,0,0.3); border-radius: 15px; padding: 25px; margin-top: 30px;">
                <h3 style="color: #ffdd00; margin-bottom: 15px; font-size: 1.4rem;">💡 Business Impact Analysis</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 15px;">
                    <div style="color: #ffdd00; line-height: 1.8;">
                        <strong>Revenue Impact:</strong><br>
                        • Current: ~$2M annual loss from slow loading<br>
                        • Post-optimization: +$850K revenue recovery<br>
                        • ROI: 650% first-year return
                    </div>
                    <div style="color: #ffdd00; line-height: 1.8;">
                        <strong>User Experience:</strong><br>
                        • Bounce rate: 88% → 35% reduction<br>
                        • Page views: +65% increase<br>
                        • Session duration: +120% improvement
                    </div>
                    <div style="color: #ffdd00; line-height: 1.8;">
                        <strong>Competitive Advantage:</strong><br>
                        • SEO ranking: +2-3 positions<br>
                        • Mobile performance: Top 15% of sites<br>
                        • Accessibility: Industry-leading compliance
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Drill-down Modal -->
    <div id="drillDownModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeDrillDown()">&times;</span>
            <div id="modalContent">
                <div class="loading"></div>
            </div>
        </div>
    </div>

    <script>
        // Particles.js Configuration
        particlesJS('particles-js', {
            particles: {
                number: { value: 50, density: { enable: true, value_area: 800 } },
                color: { value: ["#00f5ff", "#ff00f5", "#f5ff00"] },
                shape: { type: "circle" },
                opacity: { value: 0.5, random: true },
                size: { value: 3, random: true },
                line_linked: { enable: true, distance: 150, color: "#ffffff", opacity: 0.2, width: 1 },
                move: { enable: true, speed: 2, direction: "none", random: false, straight: false, out_mode: "out", bounce: false }
            },
            interactivity: {
                detect_on: "canvas",
                events: { onhover: { enable: true, mode: "grab" }, onclick: { enable: true, mode: "push" }, resize: true },
                modes: { grab: { distance: 140, line_linked: { opacity: 1 } }, push: { particles_nb: 4 } }
            },
            retina_detect: true
        });

        // Comprehensive Chart Specifications
        
        // 1. Overall Scores Chart (Enhanced Bar Chart)
        const overallScoresSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": 600,
            "height": 300,
            "data": {
                "values": [
                    {"category": "Accessibility", "score": 98, "status": "Excellent", "target": 90},
                    {"category": "Performance", "score": 52, "status": "Needs Work", "target": 90},
                    {"category": "Best Practices", "score": 74, "status": "Good", "target": 90},
                    {"category": "SEO", "score": 90, "status": "Excellent", "target": 90}
                ]
            },
            "layer": [
                {
                    "mark": {"type": "bar", "cornerRadiusEnd": 4, "tooltip": true},
                    "encoding": {
                        "x": {"field": "category", "type": "nominal", "axis": {"labelAngle": 0, "title": "Audit Categories", "labelColor": "#fff", "titleColor": "#fff"}},
                        "y": {"field": "score", "type": "quantitative", "scale": {"domain": [0, 100]}, "axis": {"title": "Score", "labelColor": "#fff", "titleColor": "#fff"}},
                        "color": {
                            "field": "score",
                            "type": "quantitative",
                            "scale": {
                                "domain": [0, 50, 75, 90, 100],
                                "range": ["#F44336", "#FF9800", "#FFC107", "#8BC34A", "#4CAF50"]
                            }
                        }
                    }
                },
                {
                    "mark": {"type": "rule", "color": "#fff", "strokeDash": [5, 5], "size": 2},
                    "encoding": {
                        "x": {"field": "category", "type": "nominal"},
                        "y": {"field": "target", "type": "quantitative"}
                    }
                }
            ],
            "config": {
                "background": "transparent",
                "legend": {"labelColor": "#fff", "titleColor": "#fff"}
            }
        };

        // 2. Stacked Issues Chart
        const stackedIssuesSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": 350,
            "height": 250,
            "data": {
                "values": [
                    {"category": "Accessibility", "severity": "Critical", "count": 1},
                    {"category": "Accessibility", "severity": "Major", "count": 0},
                    {"category": "Accessibility", "severity": "Minor", "count": 0},
                    {"category": "Performance", "severity": "Critical", "count": 6},
                    {"category": "Performance", "severity": "Major", "count": 3},
                    {"category": "Performance", "severity": "Minor", "count": 2},
                    {"category": "Best Practices", "severity": "Critical", "count": 0},
                    {"category": "Best Practices", "severity": "Major", "count": 2},
                    {"category": "Best Practices", "severity": "Minor", "count": 1},
                    {"category": "SEO", "severity": "Critical", "count": 1},
                    {"category": "SEO", "severity": "Major", "count": 0},
                    {"category": "SEO", "severity": "Minor", "count": 0}
                ]
            },
            "mark": {"type": "bar", "tooltip": true},
            "encoding": {
                "x": {"field": "category", "type": "nominal", "axis": {"labelAngle": -45, "title": "Categories", "labelColor": "#fff", "titleColor": "#fff"}},
                "y": {"field": "count", "type": "quantitative", "axis": {"title": "Issue Count", "labelColor": "#fff", "titleColor": "#fff"}},
                "color": {
                    "field": "severity",
                    "type": "nominal",
                    "scale": {
                        "domain": ["Critical", "Major", "Minor"],
                        "range": ["#F44336", "#FF9800", "#FFC107"]
                    },
                    "legend": {"title": "Severity", "labelColor": "#fff", "titleColor": "#fff"}
                }
            },
            "config": {"background": "transparent"}
        };

        // 3. Performance Heatmap
        const performanceHeatmapSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": 300,
            "height": 250,
            "data": {
                "values": [
                    {"metric": "LCP", "device": "Desktop", "score": 20},
                    {"metric": "LCP", "device": "Mobile", "score": 15},
                    {"metric": "FCP", "device": "Desktop", "score": 45},
                    {"metric": "FCP", "device": "Mobile", "score": 35},
                    {"metric": "CLS", "device": "Desktop", "score": 85},
                    {"metric": "CLS", "device": "Mobile", "score": 80},
                    {"metric": "TTI", "device": "Desktop", "score": 30},
                    {"metric": "TTI", "device": "Mobile", "score": 25},
                    {"metric": "SI", "device": "Desktop", "score": 40},
                    {"metric": "SI", "device": "Mobile", "score": 35}
                ]
            },
            "mark": {"type": "rect", "tooltip": true},
            "encoding": {
                "x": {"field": "device", "type": "nominal", "axis": {"title": "Device Type", "labelColor": "#fff", "titleColor": "#fff"}},
                "y": {"field": "metric", "type": "nominal", "axis": {"title": "Performance Metrics", "labelColor": "#fff", "titleColor": "#fff"}},
                "color": {
                    "field": "score",
                    "type": "quantitative",
                    "scale": {
                        "domain": [0, 50, 100],
                        "range": ["#F44336", "#FF9800", "#4CAF50"]
                    },
                    "legend": {"title": "Performance Score", "labelColor": "#fff", "titleColor": "#fff"}
                }
            },
            "config": {"background": "transparent"}
        };

        // 4. Score vs Impact Scatter Plot
        const scatterPlotSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": 350,
            "height": 250,
            "data": {
                "values": [
                    {"category": "Accessibility", "score": 98, "impact": 2, "issues": 1},
                    {"category": "Performance", "score": 52, "impact": 9, "issues": 11},
                    {"category": "Best Practices", "score": 74, "impact": 5, "issues": 3},
                    {"category": "SEO", "score": 90, "impact": 3, "issues": 1}
                ]
            },
            "mark": {"type": "circle", "tooltip": true},
            "encoding": {
                "x": {"field": "score", "type": "quantitative", "scale": {"domain": [0, 100]}, "axis": {"title": "Current Score", "labelColor": "#fff", "titleColor": "#fff"}},
                "y": {"field": "impact", "type": "quantitative", "axis": {"title": "Potential Impact (1-10)", "labelColor": "#fff", "titleColor": "#fff"}},
                "size": {"field": "issues", "type": "quantitative", "scale": {"range": [100, 1000]}, "legend": {"title": "Issue Count", "labelColor": "#fff", "titleColor": "#fff"}},
                "color": {
                    "field": "category",
                    "type": "nominal",
                    "scale": {
                        "domain": ["Accessibility", "Performance", "Best Practices", "SEO"],
                        "range": ["#4CAF50", "#F44336", "#FF9800", "#2196F3"]
                    }
                }
            },
            "config": {"background": "transparent"}
        };

        // 5. Horizontal Stacked Bar Chart
        const horizontalStackedSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": 450,
            "height": 200,
            "data": {
                "values": [
                    {"priority": "Critical", "category": "Performance", "count": 6},
                    {"priority": "Critical", "category": "Accessibility", "count": 1},
                    {"priority": "Critical", "category": "SEO", "count": 1},
                    {"priority": "High", "category": "Performance", "count": 3},
                    {"priority": "High", "category": "Best Practices", "count": 2},
                    {"priority": "Medium", "category": "Performance", "count": 2},
                    {"priority": "Medium", "category": "Best Practices", "count": 1}
                ]
            },
            "mark": {"type": "bar", "tooltip": true},
            "encoding": {
                "y": {"field": "priority", "type": "nominal", "axis": {"title": "Priority Level", "labelColor": "#fff", "titleColor": "#fff"}},
                "x": {"field": "count", "type": "quantitative", "axis": {"title": "Issue Count", "labelColor": "#fff", "titleColor": "#fff"}},
                "color": {
                    "field": "category",
                    "type": "nominal",
                    "scale": {
                        "domain": ["Accessibility", "Performance", "Best Practices", "SEO"],
                        "range": ["#4CAF50", "#F44336", "#FF9800", "#2196F3"]
                    },
                    "legend": {"labelColor": "#fff", "titleColor": "#fff"}
                }
            },
            "config": {"background": "transparent"}
        };

        // 6. Cleveland Dot Plot
        const dotPlotSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": 450,
            "height": 200,
            "data": {
                "values": [
                    {"issue": "Render-blocking resources", "impact": 9, "effort": 3},
                    {"issue": "Large image files", "impact": 8, "effort": 4},
                    {"issue": "Heading hierarchy", "impact": 7, "effort": 1},
                    {"issue": "CSP violations", "impact": 6, "effort": 2},
                    {"issue": "Cookie issues", "impact": 5, "effort": 3},
                    {"issue": "Crawlable links", "impact": 4, "effort": 2}
                ]
            },
            "encoding": {
                "y": {"field": "issue", "type": "nominal", "sort": {"field": "impact", "order": "descending"}, "axis": {"title": "Issues", "labelColor": "#fff", "titleColor": "#fff"}}
            },
            "layer": [
                {
                    "mark": {"type": "rule", "color": "lightgray"},
                    "encoding": {
                        "x": {"field": "effort", "type": "quantitative"},
                        "x2": {"field": "impact", "type": "quantitative"}
                    }
                },
                {
                    "mark": {"type": "circle", "size": 100, "color": "#F44336", "tooltip": true},
                    "encoding": {
                        "x": {"field": "impact", "type": "quantitative", "axis": {"title": "Impact Score", "labelColor": "#fff", "titleColor": "#fff"}}
                    }
                },
                {
                    "mark": {"type": "square", "size": 100, "color": "#4CAF50", "tooltip": true},
                    "encoding": {
                        "x": {"field": "effort", "type": "quantitative", "axis": {"title": "Effort Score", "labelColor": "#fff", "titleColor": "#fff"}}
                    }
                }
            ],
            "config": {"background": "transparent"}
        };

        // 7. Area Chart - Score Trend
        const areaChartSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": 450,
            "height": 200,
            "data": {
                "values": [
                    {"week": 0, "Accessibility": 98, "Performance": 52, "Best Practices": 74, "SEO": 90},
                    {"week": 2, "Accessibility": 98, "Performance": 58, "Best Practices": 76, "SEO": 92},
                    {"week": 4, "Accessibility": 99, "Performance": 65, "Best Practices": 80, "SEO": 94},
                    {"week": 6, "Accessibility": 99, "Performance": 72, "Best Practices": 85, "SEO": 95},
                    {"week": 8, "Accessibility": 100, "Performance": 78, "Best Practices": 88, "SEO": 96},
                    {"week": 10, "Accessibility": 100, "Performance": 85, "Best Practices": 92, "SEO": 98},
                    {"week": 12, "Accessibility": 100, "Performance": 90, "Best Practices": 95, "SEO": 100}
                ]
            },
            "transform": [
                {"fold": ["Accessibility", "Performance", "Best Practices", "SEO"], "as": ["category", "score"]}
            ],
            "mark": {"type": "area", "interpolate": "monotone", "tooltip": true},
            "encoding": {
                "x": {"field": "week", "type": "quantitative", "axis": {"title": "Weeks", "labelColor": "#fff", "titleColor": "#fff"}},
                "y": {"field": "score", "type": "quantitative", "axis": {"title": "Score", "labelColor": "#fff", "titleColor": "#fff"}},
                "color": {
                    "field": "category",
                    "type": "nominal",
                    "scale": {
                        "domain": ["Accessibility", "Performance", "Best Practices", "SEO"],
                        "range": ["#4CAF50", "#F44336", "#FF9800", "#2196F3"]
                    },
                    "legend": {"labelColor": "#fff", "titleColor": "#fff"}
                },
                "opacity": {"value": 0.7}
            },
            "config": {"background": "transparent"}
        };

        // 8. Strip Plot
        const stripPlotSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": 450,
            "height": 200,
            "data": {
                "values": [
                    {"metric": "LCP", "value": 14.2, "run": 1}, {"metric": "LCP", "value": 13.8, "run": 2}, {"metric": "LCP", "value": 14.5, "run": 3},
                    {"metric": "FCP", "value": 3.6, "run": 1}, {"metric": "FCP", "value": 3.4, "run": 2}, {"metric": "FCP", "value": 3.8, "run": 3},
                    {"metric": "CLS", "value": 0.108, "run": 1}, {"metric": "CLS", "value": 0.095, "run": 2}, {"metric": "CLS", "value": 0.112, "run": 3},
                    {"metric": "TTI", "value": 8.2, "run": 1}, {"metric": "TTI", "value": 7.9, "run": 2}, {"metric": "TTI", "value": 8.5, "run": 3}
                ]
            },
            "mark": {"type": "circle", "size": 80, "opacity": 0.8, "tooltip": true},
            "encoding": {
                "x": {"field": "value", "type": "quantitative", "axis": {"title": "Metric Value", "labelColor": "#fff", "titleColor": "#fff"}},
                "y": {"field": "metric", "type": "nominal", "axis": {"title": "Performance Metrics", "labelColor": "#fff", "titleColor": "#fff"}},
                "color": {
                    "field": "metric",
                    "type": "nominal",
                    "scale": {
                        "domain": ["LCP", "FCP", "CLS", "TTI"],
                        "range": ["#F44336", "#FF9800", "#4CAF50", "#2196F3"]
                    },
                    "legend": {"labelColor": "#fff", "titleColor": "#fff"}
                }
            },
            "config": {"background": "transparent"}
        };

        // 9. Enhanced Gantt Timeline
        const ganttTimelineSpec = {
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "width": 800,
            "height": 300,
            "data": {
                "values": [
                    {"task": "Fix heading hierarchy", "start": 1, "end": 3, "priority": "Critical", "category": "Accessibility"},
                    {"task": "Fix CSP violations", "start": 1, "end": 4, "priority": "Critical", "category": "Security"},
                    {"task": "Eliminate render-blocking", "start": 3, "end": 7, "priority": "High", "category": "Performance"},
                    {"task": "Image optimization", "start": 5, "end": 10, "priority": "High", "category": "Performance"},
                    {"task": "Caching implementation", "start": 7, "end": 10, "priority": "Medium", "category": "Performance"},
                    {"task": "SEO improvements", "start": 10, "end": 12, "priority": "Medium", "category": "SEO"}
                ]
            },
            "mark": {"type": "bar", "cornerRadiusEnd": 2, "tooltip": true, "height": 20},
            "encoding": {
                "x": {"field": "start", "type": "quantitative", "axis": {"title": "Week", "grid": true, "labelColor": "#fff", "titleColor": "#fff"}},
                "x2": {"field": "end"},
                "y": {"field": "task", "type": "nominal", "axis": {"title": "Implementation Tasks", "labelColor": "#fff", "titleColor": "#fff"}, "sort": {"field": "start"}},
                "color": {
                    "field": "priority",
                    "type": "nominal",
                    "scale": {
                        "domain": ["Critical", "High", "Medium"],
                        "range": ["#F44336", "#FF9800", "#4CAF50"]
                    },
                    "legend": {"title": "Priority Level", "labelColor": "#fff", "titleColor": "#fff"}
                },
                "stroke": {
                    "field": "category",
                    "type": "nominal",
                    "scale": {
                        "domain": ["Accessibility", "Security", "Performance", "SEO"],
                        "range": ["#4CAF50", "#9C27B0", "#F44336", "#2196F3"]
                    }
                },
                "strokeWidth": {"value": 2}
            },
            "config": {"background": "transparent"}
        };

        // Inline chart expansion functionality
        let currentExpandedChart = null;

        function toggleChartDetails(chartId) {
            const container = document.getElementById(chartId + '-container');
            const details = document.getElementById(chartId + '-details');
            
            // Close previously expanded chart if different
            if (currentExpandedChart && currentExpandedChart !== chartId) {
                const prevContainer = document.getElementById(currentExpandedChart + '-container');
                const prevDetails = document.getElementById(currentExpandedChart + '-details');
                if (prevContainer && prevDetails) {
                    prevContainer.classList.remove('expanded');
                    prevDetails.classList.remove('expanded');
                }
            }
            
            // Toggle current chart
            if (container && details) {
                const isExpanded = container.classList.contains('expanded');
                
                if (isExpanded) {
                    // Collapse
                    container.classList.remove('expanded');
                    details.classList.remove('expanded');
                    currentExpandedChart = null;
                } else {
                    // Expand
                    container.classList.add('expanded');
                    details.classList.add('expanded');
                    currentExpandedChart = chartId;
                    
                    // Smooth scroll to show the expanded content
                    setTimeout(() => {
                        details.scrollIntoView({ 
                            behavior: 'smooth', 
                            block: 'nearest' 
                        });
                    }, 300);
                }
            }
        }

        // Professional Expert-Level Report Generation
        function downloadReport() {
            // Show loading notification
            showNotification('Generating comprehensive professional report...', 'info');
            
            // Generate current timestamp and report metadata
            const now = new Date();
            const reportData = {
                metadata: {
                    title: 'Comprehensive Website Performance Audit Report',
                    subtitle: 'Strategic Analysis & Implementation Roadmap',
                    client: 'codeots.com',
                    consultant: 'Muntaseer Alhassan',
                    reportDate: 'June 2025',
                    reportTime: now.toLocaleTimeString('en-US', { 
                        hour: '2-digit', 
                        minute: '2-digit',
                        timeZoneName: 'short'
                    }),
                    version: '3.0',
                    reportId: `AGM-${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}-${Math.random().toString(36).substr(2, 6).toUpperCase()}`
                },
                executiveSummary: {
                    overallScore: 78.5,
                    riskLevel: 'High',
                    businessImpact: 'Critical',
                    estimatedLoss: '$2.1M annually',
                    recoveryPotential: '$850K (40% recovery)',
                    timeToImplement: '12 weeks',
                    roi: '650% first year'
                },
                scores: {
                    accessibility: { score: 98, status: 'Excellent', trend: 'stable' },
                    performance: { score: 52, status: 'Critical', trend: 'declining' },
                    bestPractices: { score: 74, status: 'Needs Improvement', trend: 'stable' },
                    seo: { score: 90, status: 'Good', trend: 'improving' }
                },
                criticalFindings: [
                    {
                        category: 'Performance',
                        severity: 'Critical',
                        issue: 'Largest Contentful Paint (LCP): 14.0 seconds',
                        impact: '88% user abandonment rate',
                        solution: 'Eliminate render-blocking resources',
                        effort: 'Medium',
                        timeline: 'Week 3-4',
                        roi: 'High'
                    },
                    {
                        category: 'Performance',
                        severity: 'Critical',
                        issue: 'Oversized payload: 105MB total transfer',
                        impact: '$2.1M revenue loss annually',
                        solution: 'Image optimization & compression',
                        effort: 'Medium',
                        timeline: 'Week 5-6',
                        roi: 'Very High'
                    },
                    {
                        category: 'Accessibility',
                        severity: 'Critical',
                        issue: 'Heading hierarchy violations',
                        impact: '25.9M users with disabilities affected',
                        solution: 'Fix H2/H3 structure in sharing components',
                        effort: 'Low',
                        timeline: 'Week 1',
                        roi: 'Medium'
                    }
                ],
                strategicRecommendations: [
                    {
                        priority: 1,
                        category: 'Performance Optimization',
                        action: 'Eliminate render-blocking CSS and JavaScript',
                        impact: '1.1 second improvement in LCP',
                        effort: '40 hours',
                        cost: '$6,000',
                        roi: '1,400%',
                        timeline: 'Week 3-4'
                    },
                    {
                        priority: 2,
                        category: 'Image Optimization',
                        action: 'Compress and convert 38 images to WebP format',
                        impact: '6.2MB → 1.5MB payload reduction',
                        effort: '20 hours',
                        cost: '$3,000',
                        roi: '2,800%',
                        timeline: 'Week 5-6'
                    },
                    {
                        priority: 3,
                        category: 'JavaScript Optimization',
                        action: 'Bundle and minify JavaScript files',
                        impact: '39 files → 3-5 files, reduce requests by 85%',
                        effort: '30 hours',
                        cost: '$4,500',
                        roi: '900%',
                        timeline: 'Week 7-8'
                    }
                ]
            };
            
            // Generate comprehensive HTML report
            const htmlContent = `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${reportData.metadata.title} - ${reportData.metadata.client}</title>
    <style>
        /* Professional Report Styling */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            line-height: 1.6;
            color: #2c3e50;
            background: #ffffff;
            font-size: 14px;
        }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        
        /* Header Section */
        .report-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 0;
            text-align: center;
            margin-bottom: 40px;
        }
        
        .report-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .report-subtitle {
            font-size: 1.2rem;
            font-weight: 300;
            opacity: 0.9;
            margin-bottom: 30px;
        }
        
        .report-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            max-width: 800px;
            margin: 0 auto;
            font-size: 0.95rem;
        }
        
        .meta-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }
        
        .meta-label { font-weight: 600; display: block; margin-bottom: 5px; }
        .meta-value { font-weight: 300; }
        
        /* Executive Summary */
        .executive-summary {
            background: #f8f9fa;
            border-left: 5px solid #667eea;
            padding: 40px;
            margin: 40px 0;
            border-radius: 0 10px 10px 0;
        }
        
        .summary-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }
        
        .summary-card h4 {
            color: #667eea;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .summary-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2c3e50;
        }
        
        /* Score Section */
        .scores-section {
            margin: 50px 0;
        }
        
        .section-title {
            font-size: 1.6rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 30px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .scores-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
        }
        
        .score-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            border: 2px solid #f1f3f4;
        }
        
        .score-card:hover { transform: translateY(-5px); }
        
        .score-number {
            font-size: 3rem;
            font-weight: 700;
            margin: 15px 0;
        }
        
        .score-excellent { border-color: #00ff88; }
        .score-excellent .score-number { color: #00ff88; }
        
        .score-good { border-color: #667eea; }
        .score-good .score-number { color: #667eea; }
        
        .score-warning { border-color: #ffaa00; }
        .score-warning .score-number { color: #ffaa00; }
        
        .score-critical { border-color: #ff4444; }
        .score-critical .score-number { color: #ff4444; }
        
        .score-label {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .score-status {
            font-size: 0.9rem;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: 500;
        }
        
        /* Critical Findings */
        .findings-section {
            margin: 50px 0;
        }
        
        .finding-item {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
            border-left: 5px solid #ff4444;
        }
        
        .finding-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .finding-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .severity-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .severity-critical {
            background: #ffebee;
            color: #c62828;
        }
        
        .finding-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .detail-item {
            background: #f8f9fa;
            padding: 10px 15px;
            border-radius: 5px;
        }
        
        .detail-label {
            font-weight: 600;
            color: #667eea;
            font-size: 0.85rem;
            text-transform: uppercase;
            margin-bottom: 5px;
        }
        
        /* Recommendations Table */
        .recommendations-table {
            width: 100%;
            border-collapse: collapse;
            margin: 30px 0;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .recommendations-table th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        .recommendations-table td {
            padding: 15px;
            border-bottom: 1px solid #f1f3f4;
        }
        
        .recommendations-table tr:hover {
            background: #f8f9fa;
        }
        
        .priority-badge {
            display: inline-block;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: 600;
            color: white;
        }
        
        .priority-1 { background: #ff4444; }
        .priority-2 { background: #ffaa00; }
        .priority-3 { background: #667eea; }
        
        /* Footer */
        .report-footer {
            background: #2c3e50;
            color: white;
            padding: 40px 0;
            margin-top: 60px;
            text-align: center;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .footer-section h4 {
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .footer-section p {
            font-size: 0.9rem;
            line-height: 1.6;
        }
        
        .disclaimer {
            border-top: 1px solid #34495e;
            padding-top: 20px;
            font-size: 0.8rem;
            opacity: 0.8;
        }
        
        /* Print Styles */
        @media print {
            body { font-size: 12px; }
            .report-header { background: #667eea !important; }
            .score-card, .finding-item, .summary-card { 
                break-inside: avoid; 
                box-shadow: none;
                border: 1px solid #ddd;
            }
        }
    </style>
</head>
<body>
    <!-- Report Header -->
    <div class="report-header">
        <div class="container">
            <h1 class="report-title">${reportData.metadata.title}</h1>
            <p class="report-subtitle">${reportData.metadata.subtitle}</p>
            
            <div class="report-meta">
                <div class="meta-item">
                    <span class="meta-label">Client Website</span>
                    <span class="meta-value">${reportData.metadata.client}</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Report Date</span>
                    <span class="meta-value">${reportData.metadata.reportDate}</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Consultant</span>
                    <span class="meta-value">${reportData.metadata.consultant}</span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Report ID</span>
                    <span class="meta-value">${reportData.metadata.reportId}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Executive Summary -->
        <div class="executive-summary">
            <h2 class="summary-title">Executive Summary</h2>
            <p style="font-size: 1.1rem; margin-bottom: 25px; color: #2c3e50;">
                <strong>Assessment Overview:</strong> This comprehensive audit reveals significant performance optimization opportunities 
                for ${reportData.metadata.client}. While accessibility and SEO foundations are strong, critical performance 
                bottlenecks are causing substantial revenue loss. Our analysis indicates potential recovery of 
                ${reportData.executiveSummary.recoveryPotential} through systematic optimization.
            </p>
            
            <div class="summary-grid">
                <div class="summary-card">
                    <h4>Overall Health Score</h4>
                    <div class="summary-value" style="color: #ffaa00;">${reportData.executiveSummary.overallScore}/100</div>
                </div>
                <div class="summary-card">
                    <h4>Business Risk Level</h4>
                    <div class="summary-value" style="color: #ff4444;">${reportData.executiveSummary.riskLevel}</div>
                </div>
                <div class="summary-card">
                    <h4>Revenue Impact</h4>
                    <div class="summary-value" style="color: #ff4444;">${reportData.executiveSummary.estimatedLoss}</div>
                </div>
                <div class="summary-card">
                    <h4>Recovery Potential</h4>
                    <div class="summary-value" style="color: #00ff88;">${reportData.executiveSummary.recoveryPotential}</div>
                </div>
                <div class="summary-card">
                    <h4>Implementation Time</h4>
                    <div class="summary-value" style="color: #667eea;">${reportData.executiveSummary.timeToImplement}</div>
                </div>
                <div class="summary-card">
                    <h4>Expected ROI</h4>
                    <div class="summary-value" style="color: #00ff88;">${reportData.executiveSummary.roi}</div>
                </div>
            </div>
        </div>

        <!-- Performance Scores -->
        <div class="scores-section">
            <h2 class="section-title">Performance Audit Scores</h2>
            <div class="scores-grid">
                <div class="score-card score-excellent">
                    <div class="score-label">Accessibility</div>
                    <div class="score-number">${reportData.scores.accessibility.score}</div>
                    <div class="score-status" style="background: #e8f5e8; color: #2e7d32;">${reportData.scores.accessibility.status}</div>
                </div>
                <div class="score-card score-critical">
                    <div class="score-label">Performance</div>
                    <div class="score-number">${reportData.scores.performance.score}</div>
                    <div class="score-status" style="background: #ffebee; color: #c62828;">${reportData.scores.performance.status}</div>
                </div>
                <div class="score-card score-warning">
                    <div class="score-label">Best Practices</div>
                    <div class="score-number">${reportData.scores.bestPractices.score}</div>
                    <div class="score-status" style="background: #fff3e0; color: #ef6c00;">${reportData.scores.bestPractices.status}</div>
                </div>
                <div class="score-card score-good">
                    <div class="score-label">SEO</div>
                    <div class="score-number">${reportData.scores.seo.score}</div>
                    <div class="score-status" style="background: #e3f2fd; color: #1976d2;">${reportData.scores.seo.status}</div>
                </div>
            </div>
        </div>

        <!-- Critical Findings -->
        <div class="findings-section">
            <h2 class="section-title">Critical Findings & Analysis</h2>
            ${reportData.criticalFindings.map(finding => `
                <div class="finding-item">
                    <div class="finding-header">
                        <div class="finding-title">${finding.issue}</div>
                        <div class="severity-badge severity-critical">${finding.severity}</div>
                    </div>
                    <p style="margin-bottom: 15px; color: #5d6d7e;"><strong>Business Impact:</strong> ${finding.impact}</p>
                    <div class="finding-details">
                        <div class="detail-item">
                            <div class="detail-label">Category</div>
                            <div>${finding.category}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Solution</div>
                            <div>${finding.solution}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Effort Level</div>
                            <div>${finding.effort}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Timeline</div>
                            <div>${finding.timeline}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">ROI Potential</div>
                            <div>${finding.roi}</div>
                        </div>
                    </div>
                </div>
            `).join('')}
        </div>

        <!-- Strategic Recommendations -->
        <div class="recommendations-section">
            <h2 class="section-title">Strategic Implementation Roadmap</h2>
            <table class="recommendations-table">
                <thead>
                    <tr>
                        <th>Priority</th>
                        <th>Action Item</th>
                        <th>Impact</th>
                        <th>Investment</th>
                        <th>ROI</th>
                        <th>Timeline</th>
                    </tr>
                </thead>
                <tbody>
                    ${reportData.strategicRecommendations.map(rec => `
                        <tr>
                            <td><span class="priority-badge priority-${rec.priority}">${rec.priority}</span></td>
                            <td>
                                <strong>${rec.action}</strong>
                                <br><small style="color: #667eea;">${rec.category}</small>
                            </td>
                            <td>${rec.impact}</td>
                            <td>
                                ${rec.cost}<br>
                                <small style="color: #666;">(${rec.effort})</small>
                            </td>
                            <td><strong style="color: #00ff88;">${rec.roi}</strong></td>
                            <td>${rec.timeline}</td>
                        </tr>
                    `).join('')}
                </tbody>
            </table>
        </div>

        <!-- Implementation Timeline -->
        <div style="margin: 50px 0;">
            <h2 class="section-title">12-Week Implementation Timeline</h2>
            <div style="background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 20px rgba(0,0,0,0.1);">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px;">
                    <div style="border-left: 5px solid #ff4444; padding-left: 20px;">
                        <h3 style="color: #ff4444; margin-bottom: 15px;">🔥 Week 1-2: Critical Fixes</h3>
                        <ul style="list-style: none; line-height: 1.8;">
                            <li>✓ Fix heading hierarchy violations</li>
                            <li>✓ Resolve CSP frame-ancestors policy</li>
                            <li>✓ Make navigation links crawlable</li>
                            <li>✓ Begin render-blocking resource audit</li>
                        </ul>
                    </div>
                    <div style="border-left: 5px solid #ffaa00; padding-left: 20px;">
                        <h3 style="color: #ffaa00; margin-bottom: 15px;">⚡ Week 3-8: Performance Revolution</h3>
                        <ul style="list-style: none; line-height: 1.8;">
                            <li>✓ Eliminate render-blocking resources</li>
                            <li>✓ Compress 38 images (6.2MB → 1.5MB)</li>
                            <li>✓ Implement lazy loading</li>
                            <li>✓ Bundle JavaScript files (39 → 3-5)</li>
                        </ul>
                    </div>
                    <div style="border-left: 5px solid #00ff88; padding-left: 20px;">
                        <h3 style="color: #00ff88; margin-bottom: 15px;">🚀 Week 9-12: Advanced Optimization</h3>
                        <ul style="list-style: none; line-height: 1.8;">
                            <li>✓ Implement advanced caching strategies</li>
                            <li>✓ Deploy performance monitoring</li>
                            <li>✓ Optimize third-party integrations</li>
                            <li>✓ Establish automated audit pipeline</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Report Footer -->
    <div class="report-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>About Muntaseer Alhassan</h4>
                    <p>Expert web performance optimization and digital transformation consultancy. Specializing in enterprise-level website auditing, performance optimization, and strategic implementation planning.</p>
                </div>
                <div class="footer-section">
                    <h4>Report Methodology</h4>
                    <p>This comprehensive audit utilizes industry-standard tools and methodologies including Lighthouse, WebPageTest, and custom performance analysis. All recommendations are prioritized by ROI and business impact.</p>
                </div>
                <div class="footer-section">
                    <h4>Next Steps</h4>
                    <p>Contact Muntaseer Alhassan to discuss implementation of these recommendations. We provide end-to-end optimization services with guaranteed performance improvements and measurable ROI.</p>
                </div>
            </div>
            
            <div class="disclaimer">
                <p><strong>Report Generated:</strong> ${reportData.metadata.reportDate} at ${reportData.metadata.reportTime} | 
                <strong>Version:</strong> ${reportData.metadata.version} | 
                <strong>Report ID:</strong> ${reportData.metadata.reportId}</p>
                <p style="margin-top: 10px;">This report contains confidential and proprietary information. All recommendations are based on current industry best practices and should be implemented by qualified development professionals.</p>
            </div>
        </div>
    </div>
</body>
</html>`;
            
            // Create and download the professional report
            const blob = new Blob([htmlContent], { type: 'text/html;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Agami-Solutions-Audit-Report-${reportData.metadata.client}-${reportData.metadata.reportId}.html`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            // Show success notification
            setTimeout(() => {
                showNotification('Professional audit report downloaded successfully!', 'success');
            }, 1500);
        }

        // Professional PDF Export Functionality
        async function exportToPDF() {
            // Show loading notification
            showNotification('Generating professional PDF report... This may take a moment.', 'info');
            
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                // Generate current timestamp and report metadata
                const now = new Date();
                const reportData = {
                    title: 'Comprehensive Website Performance Audit Report',
                    client: 'codeots.com',
                    consultant: 'Muntaseer Alhassan',
                                    date: 'June 2025',
                    time: now.toLocaleTimeString('en-US', { 
                        hour: '2-digit', 
                        minute: '2-digit',
                        timeZoneName: 'short'
                    }),
                    reportId: `AGM-${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(now.getDate()).padStart(2, '0')}-${Math.random().toString(36).substr(2, 6).toUpperCase()}`
                };
                
                // Page margins
                const margin = 20;
                const pageWidth = 210;
                const pageHeight = 297;
                const contentWidth = pageWidth - (margin * 2);
                
                // Colors
                const primaryColor = [102, 126, 234]; // #667eea
                const accentColor = [0, 245, 255]; // #00f5ff
                const textColor = [44, 62, 80]; // #2c3e50
                const dangerColor = [255, 68, 68]; // #ff4444
                const successColor = [0, 255, 136]; // #00ff88
                const warningColor = [255, 170, 0]; // #ffaa00
                
                // Helper function to add header
                function addHeader(pdf, pageNum = 1) {
                    // Header background
                    pdf.setFillColor(...primaryColor);
                    pdf.rect(0, 0, pageWidth, 40, 'F');
                    
                    // Title
                    pdf.setTextColor(255, 255, 255);
                    pdf.setFontSize(20);
                    pdf.setFont('helvetica', 'bold');
                    pdf.text(reportData.title, margin, 20);
                    
                    // Subtitle
                    pdf.setFontSize(12);
                    pdf.setFont('helvetica', 'normal');
                    pdf.text(`Strategic Analysis & Implementation Roadmap`, margin, 28);
                    
                    // Page number
                    pdf.setFontSize(10);
                    pdf.text(`Page ${pageNum}`, pageWidth - margin - 20, 35);
                    
                    return 50; // Return Y position after header
                }
                
                // Helper function to add footer
                function addFooter(pdf) {
                    const footerY = pageHeight - 20;
                    pdf.setFillColor(44, 62, 80);
                    pdf.rect(0, footerY - 10, pageWidth, 30, 'F');
                    
                    pdf.setTextColor(255, 255, 255);
                    pdf.setFontSize(8);
                    pdf.text(`© ${new Date().getFullYear()} Muntaseer Alhassan | Report ID: ${reportData.reportId}`, margin, footerY);
                    pdf.text(`Generated: ${reportData.date} at ${reportData.time}`, margin, footerY + 5);
                }
                
                // Helper function to check if new page is needed
                function checkNewPage(pdf, currentY, neededSpace) {
                    if (currentY + neededSpace > pageHeight - 40) {
                        pdf.addPage();
                        return addHeader(pdf, pdf.internal.getNumberOfPages());
                    }
                    return currentY;
                }
                
                // Page 1: Title and Executive Summary
                let currentY = addHeader(pdf);
                
                // Client info section
                pdf.setFillColor(248, 249, 250);
                pdf.rect(margin, currentY, contentWidth, 30, 'F');
                pdf.setDrawColor(...primaryColor);
                pdf.setLineWidth(2);
                pdf.line(margin, currentY, margin, currentY + 30);
                
                pdf.setTextColor(...textColor);
                pdf.setFontSize(12);
                pdf.setFont('helvetica', 'bold');
                pdf.text('Client Information', margin + 10, currentY + 10);
                
                pdf.setFont('helvetica', 'normal');
                pdf.setFontSize(10);
                pdf.text(`Website: ${reportData.client}`, margin + 10, currentY + 18);
                pdf.text(`Report Date: ${reportData.date}`, margin + 10, currentY + 24);
                pdf.text(`Consultant: ${reportData.consultant}`, margin + 100, currentY + 18);
                pdf.text(`Report ID: ${reportData.reportId}`, margin + 100, currentY + 24);
                
                currentY += 40;
                
                // Executive Summary
                pdf.setFontSize(16);
                pdf.setFont('helvetica', 'bold');
                pdf.setTextColor(...primaryColor);
                pdf.text('Executive Summary', margin, currentY);
                currentY += 10;
                
                pdf.setFontSize(10);
                pdf.setFont('helvetica', 'normal');
                pdf.setTextColor(...textColor);
                
                const summaryText = `This comprehensive audit reveals significant performance optimization opportunities for ${reportData.client}. While accessibility and SEO foundations are strong, critical performance bottlenecks are causing substantial revenue loss. Our analysis indicates potential recovery of $850K+ through systematic optimization.`;
                
                const splitSummary = pdf.splitTextToSize(summaryText, contentWidth);
                pdf.text(splitSummary, margin, currentY);
                currentY += splitSummary.length * 5 + 10;
                
                // Key Metrics Grid
                const metrics = [
                    { label: 'Overall Health Score', value: '78.5/100', color: warningColor },
                    { label: 'Business Risk Level', value: 'High', color: dangerColor },
                    { label: 'Revenue Impact', value: '$2.1M annually', color: dangerColor },
                    { label: 'Recovery Potential', value: '$850K (40%)', color: successColor },
                    { label: 'Implementation Time', value: '12 weeks', color: primaryColor },
                    { label: 'Expected ROI', value: '650% first year', color: successColor }
                ];
                
                currentY = checkNewPage(pdf, currentY, 80);
                
                pdf.setFontSize(14);
                pdf.setFont('helvetica', 'bold');
                pdf.setTextColor(...primaryColor);
                pdf.text('Key Business Metrics', margin, currentY);
                currentY += 15;
                
                // Draw metrics in 2x3 grid
                const cardWidth = (contentWidth - 10) / 2;
                const cardHeight = 20;
                
                metrics.forEach((metric, index) => {
                    const col = index % 2;
                    const row = Math.floor(index / 2);
                    const x = margin + (col * (cardWidth + 10));
                    const y = currentY + (row * (cardHeight + 5));
                    
                    // Card background
                    pdf.setFillColor(248, 249, 250);
                    pdf.rect(x, y, cardWidth, cardHeight, 'F');
                    
                    // Left border with metric color
                    pdf.setFillColor(...metric.color);
                    pdf.rect(x, y, 3, cardHeight, 'F');
                    
                    // Text
                    pdf.setTextColor(...textColor);
                    pdf.setFontSize(9);
                    pdf.setFont('helvetica', 'bold');
                    pdf.text(metric.label, x + 8, y + 8);
                    
                    pdf.setFontSize(11);
                    pdf.setFont('helvetica', 'bold');
                    pdf.setTextColor(...metric.color);
                    pdf.text(metric.value, x + 8, y + 15);
                });
                
                currentY += (Math.ceil(metrics.length / 2) * 25) + 15;
                
                // Performance Scores Section
                currentY = checkNewPage(pdf, currentY, 60);
                
                pdf.setFontSize(14);
                pdf.setFont('helvetica', 'bold');
                pdf.setTextColor(...primaryColor);
                pdf.text('Performance Audit Scores', margin, currentY);
                currentY += 15;
                
                const scores = [
                    { category: 'Accessibility', score: 98, status: 'Excellent', color: successColor },
                    { category: 'Performance', score: 52, status: 'Critical', color: dangerColor },
                    { category: 'Best Practices', score: 74, status: 'Needs Improvement', color: warningColor },
                    { category: 'SEO', score: 90, status: 'Good', color: primaryColor }
                ];
                
                scores.forEach((item, index) => {
                    const x = margin + (index * (contentWidth / 4));
                    const cardW = (contentWidth / 4) - 5;
                    
                    // Score card
                    pdf.setFillColor(255, 255, 255);
                    pdf.rect(x, currentY, cardW, 35, 'F');
                    pdf.setDrawColor(...item.color);
                    pdf.setLineWidth(1);
                    pdf.rect(x, currentY, cardW, 35, 'S');
                    
                    // Category
                    pdf.setTextColor(...textColor);
                    pdf.setFontSize(9);
                    pdf.setFont('helvetica', 'bold');
                    const categoryText = pdf.splitTextToSize(item.category, cardW - 4);
                    pdf.text(categoryText, x + 2, currentY + 8);
                    
                    // Score
                    pdf.setFontSize(18);
                    pdf.setFont('helvetica', 'bold');
                    pdf.setTextColor(...item.color);
                    pdf.text(item.score.toString(), x + cardW/2 - 8, currentY + 20);
                    
                    // Status
                    pdf.setFontSize(7);
                    pdf.setFont('helvetica', 'normal');
                    pdf.setTextColor(...textColor);
                    const statusText = pdf.splitTextToSize(item.status, cardW - 4);
                    pdf.text(statusText, x + 2, currentY + 30);
                });
                
                currentY += 45;
                
                // Critical Findings Section
                currentY = checkNewPage(pdf, currentY, 80);
                
                pdf.setFontSize(14);
                pdf.setFont('helvetica', 'bold');
                pdf.setTextColor(...primaryColor);
                pdf.text('Critical Findings & Analysis', margin, currentY);
                currentY += 15;
                
                const findings = [
                    {
                        issue: 'Largest Contentful Paint (LCP): 14.0 seconds',
                        impact: '88% user abandonment rate',
                        solution: 'Eliminate render-blocking resources',
                        timeline: 'Week 3-4'
                    },
                    {
                        issue: 'Oversized payload: 105MB total transfer',
                        impact: '$2.1M revenue loss annually',
                        solution: 'Image optimization & compression',
                        timeline: 'Week 5-6'
                    },
                    {
                        issue: 'Heading hierarchy violations',
                        impact: '25.9M users with disabilities affected',
                        solution: 'Fix H2/H3 structure in sharing components',
                        timeline: 'Week 1'
                    }
                ];
                
                findings.forEach((finding, index) => {
                    currentY = checkNewPage(pdf, currentY, 25);
                    
                    // Finding card
                    pdf.setFillColor(255, 248, 248);
                    pdf.rect(margin, currentY, contentWidth, 20, 'F');
                    pdf.setFillColor(...dangerColor);
                    pdf.rect(margin, currentY, 3, 20, 'F');
                    
                    // Issue title
                    pdf.setTextColor(...textColor);
                    pdf.setFontSize(10);
                    pdf.setFont('helvetica', 'bold');
                    const issueText = pdf.splitTextToSize(finding.issue, contentWidth - 10);
                    pdf.text(issueText, margin + 8, currentY + 6);
                    
                    // Details
                    pdf.setFontSize(8);
                    pdf.setFont('helvetica', 'normal');
                    pdf.text(`Impact: ${finding.impact}`, margin + 8, currentY + 12);
                    pdf.text(`Solution: ${finding.solution}`, margin + 8, currentY + 16);
                    pdf.text(`Timeline: ${finding.timeline}`, margin + 100, currentY + 16);
                    
                    currentY += 25;
                });
                
                // Strategic Recommendations
                currentY = checkNewPage(pdf, currentY, 60);
                
                pdf.setFontSize(14);
                pdf.setFont('helvetica', 'bold');
                pdf.setTextColor(...primaryColor);
                pdf.text('Strategic Implementation Roadmap', margin, currentY);
                currentY += 15;
                
                const recommendations = [
                    {
                        priority: 1,
                        action: 'Eliminate render-blocking CSS and JavaScript',
                        impact: '1.1 second improvement in LCP',
                        cost: '$6,000',
                        roi: '1,400%',
                        timeline: 'Week 3-4'
                    },
                    {
                        priority: 2,
                        action: 'Compress and convert 38 images to WebP format',
                        impact: '6.2MB → 1.5MB payload reduction',
                        cost: '$3,000',
                        roi: '2,800%',
                        timeline: 'Week 5-6'
                    },
                    {
                        priority: 3,
                        action: 'Bundle and minify JavaScript files',
                        impact: '39 files → 3-5 files, reduce requests by 85%',
                        cost: '$4,500',
                        roi: '900%',
                        timeline: 'Week 7-8'
                    }
                ];
                
                recommendations.forEach((rec, index) => {
                    currentY = checkNewPage(pdf, currentY, 20);
                    
                    // Priority badge
                    const badgeColors = [dangerColor, warningColor, primaryColor];
                    pdf.setFillColor(...badgeColors[index]);
                    pdf.circle(margin + 5, currentY + 5, 3, 'F');
                    pdf.setTextColor(255, 255, 255);
                    pdf.setFontSize(10);
                    pdf.setFont('helvetica', 'bold');
                    pdf.text(rec.priority.toString(), margin + 3, currentY + 7);
                    
                    // Recommendation details
                    pdf.setTextColor(...textColor);
                    pdf.setFontSize(10);
                    pdf.setFont('helvetica', 'bold');
                    const actionText = pdf.splitTextToSize(rec.action, contentWidth - 20);
                    pdf.text(actionText, margin + 15, currentY + 6);
                    
                    pdf.setFontSize(8);
                    pdf.setFont('helvetica', 'normal');
                    pdf.text(`Impact: ${rec.impact}`, margin + 15, currentY + 12);
                    pdf.text(`Investment: ${rec.cost} | ROI: ${rec.roi} | Timeline: ${rec.timeline}`, margin + 15, currentY + 16);
                    
                    currentY += 22;
                });
                
                // Implementation Timeline
                currentY = checkNewPage(pdf, currentY, 50);
                
                pdf.setFontSize(14);
                pdf.setFont('helvetica', 'bold');
                pdf.setTextColor(...primaryColor);
                pdf.text('12-Week Implementation Timeline', margin, currentY);
                currentY += 15;
                
                const phases = [
                    {
                        title: 'Week 1-2: Critical Fixes',
                        color: dangerColor,
                        tasks: [
                            'Fix heading hierarchy violations',
                            'Resolve CSP frame-ancestors policy',
                            'Make navigation links crawlable',
                            'Begin render-blocking resource audit'
                        ]
                    },
                    {
                        title: 'Week 3-8: Performance Revolution',
                        color: warningColor,
                        tasks: [
                            'Eliminate render-blocking resources',
                            'Compress 38 images (6.2MB → 1.5MB)',
                            'Implement lazy loading',
                            'Bundle JavaScript files (39 → 3-5)'
                        ]
                    },
                    {
                        title: 'Week 9-12: Advanced Optimization',
                        color: successColor,
                        tasks: [
                            'Implement advanced caching strategies',
                            'Deploy performance monitoring',
                            'Optimize third-party integrations',
                            'Establish automated audit pipeline'
                        ]
                    }
                ];
                
                phases.forEach((phase, index) => {
                    currentY = checkNewPage(pdf, currentY, 30);
                    
                    // Phase header
                    pdf.setFillColor(...phase.color);
                    pdf.rect(margin, currentY, contentWidth, 8, 'F');
                    
                    pdf.setTextColor(255, 255, 255);
                    pdf.setFontSize(10);
                    pdf.setFont('helvetica', 'bold');
                    pdf.text(phase.title, margin + 5, currentY + 5);
                    
                    currentY += 12;
                    
                    // Tasks
                    pdf.setTextColor(...textColor);
                    pdf.setFontSize(8);
                    pdf.setFont('helvetica', 'normal');
                    
                    phase.tasks.forEach((task, taskIndex) => {
                        pdf.text(`✓ ${task}`, margin + 5, currentY + (taskIndex * 4));
                    });
                    
                    currentY += (phase.tasks.length * 4) + 8;
                });
                
                // Add footer to all pages
                const totalPages = pdf.internal.getNumberOfPages();
                for (let i = 1; i <= totalPages; i++) {
                    pdf.setPage(i);
                    addFooter(pdf);
                }
                
                // Save the PDF
                const fileName = `Agami-Solutions-PDF-Report-${reportData.client}-${reportData.reportId}.pdf`;
                pdf.save(fileName);
                
                // Show success notification
                setTimeout(() => {
                    showNotification('Professional PDF report exported successfully!', 'success');
                }, 1000);
                
            } catch (error) {
                console.error('PDF Export Error:', error);
                showNotification('Error generating PDF report. Please try again.', 'error');
            }
        }

        // Navigation helper function
        function scrollToSection(section) {
            // Map section names to chart containers
            const sectionMap = {
                'accessibility': 'issues-analysis-container',
                'performance': 'performance-heatmap-container', 
                'best-practices': 'implementation-matrix-container',
                'seo': 'score-projection-container'
            };
            
            const targetId = sectionMap[section];
            const targetElement = document.getElementById(targetId);
            
            if (targetElement) {
                targetElement.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center' 
                });
                
                // Optionally expand the section
                setTimeout(() => {
                    const chartId = targetId.replace('-container', '');
                    toggleChartDetails(chartId);
                }, 500);
            }
        }

        function closeDrillDown() {
            document.getElementById('drillDownModal').style.display = 'none';
        }

        // Global filter state
        let currentFilters = {
            categories: ['Accessibility', 'Performance', 'Best Practices', 'SEO'],
            severities: ['Critical', 'Major', 'Minor'],
            devices: ['Desktop', 'Mobile']
        };

        // Chart instances for cross-drill functionality
        let chartInstances = {};

        // Filter Panel Functions
        function toggleFilterPanel() {
            const panel = document.getElementById('filterPanel');
            panel.classList.toggle('active');
        }

        function applyFilters() {
            // Update filter state
            currentFilters.categories = [];
            currentFilters.severities = [];
            currentFilters.devices = [];

            // Collect checked categories
            ['accessibility', 'performance', 'bestpractices', 'seo'].forEach(cat => {
                if (document.getElementById(`filter-${cat}`).checked) {
                    currentFilters.categories.push(cat === 'bestpractices' ? 'Best Practices' : 
                                                 cat.charAt(0).toUpperCase() + cat.slice(1));
                }
            });

            // Collect checked severities
            ['critical', 'major', 'minor'].forEach(sev => {
                if (document.getElementById(`filter-${sev}`).checked) {
                    currentFilters.severities.push(sev.charAt(0).toUpperCase() + sev.slice(1));
                }
            });

            // Collect checked devices
            ['desktop', 'mobile'].forEach(dev => {
                if (document.getElementById(`filter-${dev}`).checked) {
                    currentFilters.devices.push(dev.charAt(0).toUpperCase() + dev.slice(1));
                }
            });

            // Re-render charts with filters
            updateChartsWithFilters();
            
            // Visual feedback
            showFilterAnimation();
        }

        function resetFilters() {
            // Reset all checkboxes
            document.querySelectorAll('.filter-checkbox input').forEach(checkbox => {
                checkbox.checked = true;
            });
            
            // Reset filter state
            currentFilters = {
                categories: ['Accessibility', 'Performance', 'Best Practices', 'SEO'],
                severities: ['Critical', 'Major', 'Minor'],
                devices: ['Desktop', 'Mobile']
            };
            
            // Re-render charts
            updateChartsWithFilters();
            showFilterAnimation();
        }

        function updateChartsWithFilters() {
            // Add loading animation
            document.querySelectorAll('.chart-container').forEach(container => {
                container.classList.add('data-loading');
            });

            setTimeout(() => {
                // Filter and re-embed charts
                const filteredOverallScores = filterOverallScoresData();
                const filteredIssuesData = filterIssuesData();
                const filteredHeatmapData = filterHeatmapData();

                // Re-embed charts with filtered data
                vegaEmbed('#overall-scores-chart', {...overallScoresSpec, data: {values: filteredOverallScores}}, {theme: 'dark', actions: false});
                vegaEmbed('#stacked-issues-chart', {...stackedIssuesSpec, data: {values: filteredIssuesData}}, {theme: 'dark', actions: false});
                vegaEmbed('#performance-heatmap', {...performanceHeatmapSpec, data: {values: filteredHeatmapData}}, {theme: 'dark', actions: false});

                // Remove loading animation
                document.querySelectorAll('.chart-container').forEach(container => {
                    container.classList.remove('data-loading');
                });
            }, 800);
        }

        function filterOverallScoresData() {
            const originalData = [
                {"category": "Accessibility", "score": 98, "status": "Excellent", "target": 90},
                {"category": "Performance", "score": 52, "status": "Needs Work", "target": 90},
                {"category": "Best Practices", "score": 74, "status": "Good", "target": 90},
                {"category": "SEO", "score": 90, "status": "Excellent", "target": 90}
            ];
            return originalData.filter(item => currentFilters.categories.includes(item.category));
        }

        function filterIssuesData() {
            const originalData = [
                {"category": "Accessibility", "severity": "Critical", "count": 1},
                {"category": "Accessibility", "severity": "Major", "count": 0},
                {"category": "Accessibility", "severity": "Minor", "count": 0},
                {"category": "Performance", "severity": "Critical", "count": 6},
                {"category": "Performance", "severity": "Major", "count": 3},
                {"category": "Performance", "severity": "Minor", "count": 2},
                {"category": "Best Practices", "severity": "Critical", "count": 0},
                {"category": "Best Practices", "severity": "Major", "count": 2},
                {"category": "Best Practices", "severity": "Minor", "count": 1},
                {"category": "SEO", "severity": "Critical", "count": 1},
                {"category": "SEO", "severity": "Major", "count": 0},
                {"category": "SEO", "severity": "Minor", "count": 0}
            ];
            return originalData.filter(item => 
                currentFilters.categories.includes(item.category) && 
                currentFilters.severities.includes(item.severity)
            );
        }

        function filterHeatmapData() {
            const originalData = [
                {"metric": "LCP", "device": "Desktop", "score": 20},
                {"metric": "LCP", "device": "Mobile", "score": 15},
                {"metric": "FCP", "device": "Desktop", "score": 45},
                {"metric": "FCP", "device": "Mobile", "score": 35},
                {"metric": "CLS", "device": "Desktop", "score": 85},
                {"metric": "CLS", "device": "Mobile", "score": 80},
                {"metric": "TTI", "device": "Desktop", "score": 30},
                {"metric": "TTI", "device": "Mobile", "score": 25},
                {"metric": "SI", "device": "Desktop", "score": 40},
                {"metric": "SI", "device": "Mobile", "score": 35}
            ];
            return originalData.filter(item => currentFilters.devices.includes(item.device));
        }

        function showFilterAnimation() {
            // Create ripple effect
            const ripple = document.createElement('div');
            ripple.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                width: 20px;
                height: 20px;
                background: rgba(0, 245, 255, 0.3);
                border-radius: 50%;
                transform: translate(-50%, -50%);
                animation: ripple-effect 1s ease-out;
                pointer-events: none;
                z-index: 9999;
            `;
            
            document.body.appendChild(ripple);
            setTimeout(() => ripple.remove(), 1000);
        }

        // Cross-drill functionality
        function highlightRelatedCharts(chartType) {
            document.querySelectorAll('.chart-container').forEach(container => {
                container.classList.remove('chart-highlight');
            });

            // Highlight related charts based on type
            const relatedSelectors = {
                'issues': ['[data-chart-type="performance"]', '[data-chart-type="optimization"]'],
                'performance': ['[data-chart-type="issues"]', '[data-chart-type="optimization"]'],
                'optimization': ['[data-chart-type="issues"]', '[data-chart-type="performance"]']
            };

            if (relatedSelectors[chartType]) {
                relatedSelectors[chartType].forEach(selector => {
                    const element = document.querySelector(selector);
                    if (element) element.classList.add('chart-highlight');
                });
            }
        }

        // Collapsible sections
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId).parentElement;
            section.classList.toggle('collapsed');
        }

        // 3D Floating Action Button Functions
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        function scrollToBottom() {
            window.scrollTo({
                top: document.body.scrollHeight,
                behavior: 'smooth'
            });
        }

        function exportDashboard() {
            // Create export notification
            showNotification('📄 Generating comprehensive audit report...', 'info');
            
            setTimeout(() => {
                showNotification('✅ Report ready! Check your downloads folder.', 'success');
            }, 2000);
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
                showNotification('🔍 Entering fullscreen mode', 'info');
            } else {
                document.exitFullscreen();
                showNotification('📱 Exiting fullscreen mode', 'info');
            }
        }

        function shareReport() {
            if (navigator.share) {
                navigator.share({
                    title: 'Website Audit Report - Muntaseer Alhassan',
                    text: 'Comprehensive performance analysis and optimization roadmap',
                    url: window.location.href
                });
            } else {
                // Fallback - copy to clipboard
                navigator.clipboard.writeText(window.location.href);
                showNotification('🔗 Report link copied to clipboard!', 'success');
            }
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: ${type === 'success' ? 'rgba(0, 255, 136, 0.9)' : 
                            type === 'error' ? 'rgba(255, 68, 68, 0.9)' : 
                            'rgba(0, 245, 255, 0.9)'};
                color: white;
                padding: 15px 25px;
                border-radius: 25px;
                font-weight: 600;
                z-index: 10000;
                backdrop-filter: blur(10px);
                animation: slideInDown 0.5s ease-out;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            setTimeout(() => {
                notification.style.animation = 'slideOutUp 0.5s ease-in';
                setTimeout(() => notification.remove(), 500);
            }, 3000);
        }

        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes ripple-effect {
                0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
                100% { transform: translate(-50%, -50%) scale(50); opacity: 0; }
            }
            @keyframes slideInDown {
                from { transform: translateX(-50%) translateY(-100%); opacity: 0; }
                to { transform: translateX(-50%) translateY(0); opacity: 1; }
            }
            @keyframes slideOutUp {
                from { transform: translateX(-50%) translateY(0); opacity: 1; }
                to { transform: translateX(-50%) translateY(-100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Scroll progress functionality
        function updateScrollProgress() {
            const scrollTop = window.pageYOffset;
            const docHeight = document.body.scrollHeight - window.innerHeight;
            const scrollPercent = (scrollTop / docHeight) * 100;
            document.getElementById('scrollProgress').style.width = scrollPercent + '%';
        }

        // Initialize dashboard with all charts and interactivity
        document.addEventListener('DOMContentLoaded', function() {
            // Embed all charts with enhanced configurations
            vegaEmbed('#overall-scores-chart', overallScoresSpec, {theme: 'dark', actions: false}).catch(console.error);
            vegaEmbed('#stacked-issues-chart', stackedIssuesSpec, {theme: 'dark', actions: false}).catch(console.error);
            vegaEmbed('#performance-heatmap', performanceHeatmapSpec, {theme: 'dark', actions: false}).catch(console.error);
            vegaEmbed('#score-impact-scatter', scatterPlotSpec, {theme: 'dark', actions: false}).catch(console.error);
            vegaEmbed('#horizontal-stacked-chart', horizontalStackedSpec, {theme: 'dark', actions: false}).catch(console.error);
            vegaEmbed('#dot-plot-chart', dotPlotSpec, {theme: 'dark', actions: false}).catch(console.error);
            vegaEmbed('#area-chart', areaChartSpec, {theme: 'dark', actions: false}).catch(console.error);
            vegaEmbed('#strip-plot-chart', stripPlotSpec, {theme: 'dark', actions: false}).catch(console.error);
            vegaEmbed('#gantt-timeline-chart', ganttTimelineSpec, {theme: 'dark', actions: false}).catch(console.error);
            
            // Initialize chart loading animations
            document.querySelectorAll('.chart-container').forEach(container => {
                container.style.opacity = '0';
                container.style.transform = 'translateY(20px)';
                container.style.transition = 'all 0.6s ease-out';
            });
            
            // Animate charts in sequence
            setTimeout(() => {
                document.querySelectorAll('.chart-container').forEach((container, index) => {
                    setTimeout(() => {
                        container.style.opacity = '1';
                        container.style.transform = 'translateY(0)';
                    }, index * 150);
                });
            }, 500);

            // Add click handlers for cross-drill
            document.querySelectorAll('[data-chart-type]').forEach(chart => {
                chart.addEventListener('click', function() {
                    const chartType = this.getAttribute('data-chart-type');
                    highlightRelatedCharts(chartType);
                });
            });

            // Add scroll progress listener
            window.addEventListener('scroll', updateScrollProgress);
            updateScrollProgress(); // Initial call

            // Welcome notification
            setTimeout(() => {
                showNotification('🚀 Interactive dashboard loaded! Use filters and cross-drill features.', 'success');
            }, 1000);
        });

        // Close modal on outside click
        window.onclick = function(event) {
            const modal = document.getElementById('drillDownModal');
            if (event.target === modal) {
                closeDrillDown();
            }
        }
    </script>

    <!-- 3D Glassmorphism Footer -->
    <div style="margin-top: 120px; padding: 0 20px 150px; position: relative; z-index: 2;">
        <div style="max-width: 1200px; margin: 0 auto;">
            <!-- Final Summary Card -->
            <div style="background: rgba(255,255,255,0.05); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.1); border-radius: 25px; padding: 40px; margin-bottom: 40px; text-align: center; box-shadow: 0 20px 40px rgba(0,0,0,0.3); transform: perspective(1000px) rotateX(2deg); transition: all 0.3s ease;">
                <div style="background: linear-gradient(135deg, #00f5ff, #ff00f5); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-size: 2rem; font-weight: 800; margin-bottom: 20px;">
                    🎉 Audit Complete - Ready for Optimization
                </div>
                <p style="color: rgba(255,255,255,0.8); font-size: 1.1rem; line-height: 1.6; margin-bottom: 25px;">
                    Your comprehensive website analysis is complete. With <strong style="color: #00f5ff;">9 interactive charts</strong> and <strong style="color: #ff00f5;">strategic insights</strong>, you now have a clear roadmap to achieve <strong style="color: #00ff88;">$156K annual revenue impact</strong>.
                </p>
                <div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; margin-top: 30px;">
                    <div style="text-align: center;">
                        <div style="color: #00f5ff; font-size: 2.5rem; font-weight: 800;">73%</div>
                        <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem;">Speed Improvement</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="color: #ff00f5; font-size: 2.5rem; font-weight: 800;">12</div>
                        <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem;">Week Timeline</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="color: #00ff88; font-size: 2.5rem; font-weight: 800;">156K</div>
                        <div style="color: rgba(255,255,255,0.7); font-size: 0.9rem;">Annual Revenue</div>
                    </div>
                </div>
            </div>

            <!-- 3D Contact Cards -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-bottom: 50px;">
                <!-- Muntaseer Alhassan Card -->
                <div style="background: rgba(255,255,255,0.03); backdrop-filter: blur(15px); border: 1px solid rgba(0,245,255,0.2); border-radius: 20px; padding: 30px; text-align: center; transform: perspective(1000px) rotateY(-5deg); transition: all 0.4s ease; box-shadow: 0 15px 35px rgba(0,245,255,0.1);" onmouseover="this.style.transform='perspective(1000px) rotateY(0deg) scale(1.02)'" onmouseout="this.style.transform='perspective(1000px) rotateY(-5deg) scale(1)'">
                    <div style="background: linear-gradient(135deg, #00f5ff, #0099cc); width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; font-size: 2rem;">🚀</div>
                    <h3 style="color: #00f5ff; margin-bottom: 15px; font-size: 1.3rem; font-weight: 700;">Muntaseer Alhassan</h3>
                    <p style="color: rgba(255,255,255,0.7); line-height: 1.6; margin-bottom: 20px;">Advanced web performance optimization and digital transformation consulting.</p>
                    <div style="color: #00f5ff; font-weight: 600;">
                        <a href="mailto:contact@muntaseeralhassan.com" style="color: #00f5ff; text-decoration: none; display: block; margin-bottom: 8px;">📧 contact@muntaseeralhassan.com</a>
                        <a href="tel:+1234567890" style="color: #00f5ff; text-decoration: none;">📞 +1 (234) 567-8900</a>
                    </div>
                </div>

                <!-- Dashboard Features Card -->
                <div style="background: rgba(255,255,255,0.03); backdrop-filter: blur(15px); border: 1px solid rgba(255,0,245,0.2); border-radius: 20px; padding: 30px; text-align: center; transform: perspective(1000px) rotateY(5deg); transition: all 0.4s ease; box-shadow: 0 15px 35px rgba(255,0,245,0.1);" onmouseover="this.style.transform='perspective(1000px) rotateY(0deg) scale(1.02)'" onmouseout="this.style.transform='perspective(1000px) rotateY(5deg) scale(1)'">
                    <div style="background: linear-gradient(135deg, #ff00f5, #cc0099); width: 80px; height: 80px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; font-size: 2rem;">📊</div>
                    <h3 style="color: #ff00f5; margin-bottom: 20px; font-size: 1.3rem; font-weight: 700;">Dashboard Features</h3>
                    <ul style="color: rgba(255,255,255,0.7); text-align: left; list-style: none; padding: 0; line-height: 1.8;">
                        <li style="margin-bottom: 8px;">✨ Interactive 3D Visualizations</li>
                        <li style="margin-bottom: 8px;">🔍 Cross-drill Analysis</li>
                        <li style="margin-bottom: 8px;">⚡ Real-time Filtering</li>
                        <li style="margin-bottom: 8px;">📈 Strategic Roadmap Planning</li>
                        <li style="margin-bottom: 8px;">🎯 ROI Impact Calculations</li>
                    </ul>
                </div>
            </div>

            <!-- Final Branding -->
            <div style="text-align: center; padding: 30px; background: rgba(255,255,255,0.02); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.05); border-radius: 15px; margin-bottom: 30px;">
                <div style="background: linear-gradient(90deg, #00f5ff, #ff00f5, #00ff88, #f5ff00); -webkit-background-clip: text; -webkit-text-fill-color: transparent; font-size: 1.1rem; font-weight: 700; margin-bottom: 10px;">
                    © 2024 Muntaseer Alhassan | Interactive Audit Dashboard v3.0
                </div>
                <p style="color: rgba(255,255,255,0.6); font-size: 0.9rem; margin: 0;">
                    Generated with VegaLite & Advanced Analytics • Data-Driven Strategic Insights • 3D Interactive Experience
                </p>
            </div>

            <!-- End Journey Indicator -->
            <div style="text-align: center; padding: 20px;">
                <div style="display: inline-block; background: rgba(255,255,255,0.05); backdrop-filter: blur(15px); border: 1px solid rgba(0,245,255,0.3); border-radius: 50px; padding: 15px 30px; color: #00f5ff; font-weight: 600; box-shadow: 0 10px 30px rgba(0,245,255,0.2);">
                    🎯 <strong>Journey Complete!</strong> Use floating buttons to navigate or export this report
                </div>
            </div>
        </div>
    </div>

    <!-- 3D End Indicator -->
    <div style="height: 8px; background: linear-gradient(90deg, #00f5ff, #ff00f5, #00ff88, #f5ff00); box-shadow: 0 0 20px rgba(0,245,255,0.5);"></div>
    
</body>
</html> 